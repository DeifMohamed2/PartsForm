<!-- Results Section -->
<div class="search2-results-section">
  <div class="container search-results-container">
    <!-- Backdrop for Filters Sidebar -->
    <div class="filters-backdrop" id="filters-backdrop"></div>

    <!-- Advanced Filters Sidebar - Professional Design -->
    <aside class="filters-sidebar" id="filters-sidebar">
      <div class="filters-header">
        <div class="filters-header-content">
          <h3 class="filters-title">Filters</h3>
          <span class="filters-subtitle">Refine your search results</span>
        </div>
        <button class="filters-close" id="filters-close">
          <i data-lucide="x"></i>
        </button>
      </div>

      <div class="filters-content">
        <!-- Active Filters Summary -->
        <div class="active-filters-bar" id="active-filters-bar" style="display: none;">
          <div class="active-filters-list" id="active-filters-list"></div>
          <button class="clear-active-filters" id="clear-active-filters">
            <i data-lucide="x"></i>
            Clear All
          </button>
        </div>

        <!-- Dynamic Filter Stats Banner -->
        <div class="filter-stats-banner" id="filter-stats-banner" style="display: none;">
          <div class="filter-stats-header">
            <i data-lucide="bar-chart-3"></i>
            <span>Filter by Search Results</span>
          </div>
          <div class="filter-stats-info">
            <span class="filter-stats-count" id="filter-stats-count">0</span> parts found
          </div>
        </div>

        <!-- Price Range with Dual Slider -->
        <div class="filter-section filter-section-enhanced">
          <div class="filter-section-header">
            <h4 class="filter-section-title">
              <i data-lucide="banknote"></i>
              Price Range
            </h4>
            <span class="filter-section-unit" id="price-currency">USD</span>
          </div>
          
          <!-- Price Range Display -->
          <div class="filter-range-display">
            <span class="range-value-min" id="price-range-min-display">0</span>
            <span class="range-separator">—</span>
            <span class="range-value-max" id="price-range-max-display">500,000</span>
          </div>
          
          <!-- Dual Range Slider -->
          <div class="dual-range-slider" id="price-slider-container">
            <div class="slider-track">
              <div class="slider-range" id="price-slider-range"></div>
            </div>
            <input type="range" class="slider-thumb slider-thumb-min" id="price-slider-min" min="0" max="500000" value="0" step="1">
            <input type="range" class="slider-thumb slider-thumb-max" id="price-slider-max" min="0" max="500000" value="500000" step="1">
          </div>
          
          <!-- Price Input Fields -->
          <div class="filter-range-inputs compact">
            <div class="filter-input-group">
              <label>Min</label>
              <input type="number" id="min-price-input" value="0" min="0" max="500000" placeholder="0">
            </div>
            <span class="filter-range-separator">–</span>
            <div class="filter-input-group">
              <label>Max</label>
              <input type="number" id="max-price-input" value="500000" min="0" max="500000" placeholder="500,000">
            </div>
          </div>
          
          <!-- Price Distribution Preview -->
          <div class="filter-distribution" id="price-distribution">
            <div class="distribution-bars">
              <!-- Bars will be generated dynamically -->
            </div>
          </div>
        </div>

        <!-- Stock Code Filter - Dynamic from Data -->
        <div class="filter-section filter-section-enhanced">
          <div class="filter-section-header">
            <h4 class="filter-section-title">
              <i data-lucide="tag"></i>
              Stock Code
            </h4>
            <span class="filter-count-badge" id="stockcode-total-count">0</span>
          </div>
          <div class="filter-options scrollable filter-options-dynamic" id="stockcode-filter-tags">
            <label class="filter-checkbox">
              <input type="checkbox" name="stockCode" value="All" data-filter="stockCode" data-value="All" checked>
              <span class="filter-checkbox-box"></span>
              <span class="filter-checkbox-label">All Stock Codes</span>
              <span class="filter-item-count" id="stockcode-all-count"></span>
            </label>
            <!-- Dynamic stock code options will be inserted here -->
          </div>
        </div>

        <!-- Brands with Dynamic Count -->
        <div class="filter-section filter-section-enhanced">
          <div class="filter-section-header">
            <h4 class="filter-section-title">
              <i data-lucide="award"></i>
              Brand
            </h4>
            <span class="filter-count-badge" id="brand-total-count">0</span>
          </div>
          <div class="filter-search-box">
            <i data-lucide="search"></i>
            <input type="text" id="brand-filter-search" placeholder="Search brands...">
            <button class="filter-search-clear" id="brand-search-clear" style="display: none;">
              <i data-lucide="x"></i>
            </button>
          </div>
          <div class="filter-options scrollable filter-options-dynamic" id="brand-filter-tags">
            <label class="filter-checkbox">
              <input type="checkbox" name="brand" value="All" data-filter="brand" data-value="All" checked>
              <span class="filter-checkbox-box"></span>
              <span class="filter-checkbox-label">All Brands</span>
              <span class="filter-item-count" id="brand-all-count"></span>
            </label>
            <!-- Dynamic brand options will be inserted here -->
          </div>
          <div class="filter-show-more" id="brand-show-more" style="display: none;">
            <button class="show-more-btn" data-target="brand">
              <span>Show more</span>
              <i data-lucide="chevron-down"></i>
            </button>
          </div>
        </div>

        <!-- Delivery Time with Slider -->
        <div class="filter-section filter-section-enhanced">
          <div class="filter-section-header">
            <h4 class="filter-section-title">
              <i data-lucide="truck"></i>
              Delivery Time
            </h4>
            <span class="filter-section-unit">days</span>
          </div>
          
          <!-- Delivery Range Display -->
          <div class="filter-range-display">
            <span class="range-value-min" id="delivery-range-min-display">0</span>
            <span class="range-separator">—</span>
            <span class="range-value-max" id="delivery-range-max-display">30+</span>
          </div>
          
          <!-- Delivery Slider -->
          <div class="dual-range-slider" id="delivery-slider-container">
            <div class="slider-track">
              <div class="slider-range" id="delivery-slider-range"></div>
            </div>
            <input type="range" class="slider-thumb slider-thumb-min" id="delivery-slider-min" min="0" max="30" value="0" step="1">
            <input type="range" class="slider-thumb slider-thumb-max" id="delivery-slider-max" min="0" max="30" value="30" step="1">
          </div>
          
          <!-- Quick Delivery Options -->
          <div class="filter-quick-options">
            <button class="filter-quick-btn" data-delivery="express" data-min="0" data-max="2">
              <i data-lucide="zap"></i>
              Express (1-2 days)
            </button>
            <button class="filter-quick-btn" data-delivery="fast" data-min="0" data-max="5">
              <i data-lucide="clock"></i>
              Fast (3-5 days)
            </button>
            <button class="filter-quick-btn" data-delivery="standard" data-min="0" data-max="14">
              <i data-lucide="calendar"></i>
              Standard (7-14 days)
            </button>
          </div>
        </div>

        <!-- Quantity Range with Slider -->
        <div class="filter-section filter-section-enhanced">
          <div class="filter-section-header">
            <h4 class="filter-section-title">
              <i data-lucide="layers"></i>
              Available Quantity
            </h4>
            <span class="filter-section-unit">units</span>
          </div>
          
          <!-- Quantity Range Display -->
          <div class="filter-range-display">
            <span class="range-value-min" id="qty-range-min-display">0</span>
            <span class="range-separator">—</span>
            <span class="range-value-max" id="qty-range-max-display">1000+</span>
          </div>
          
          <!-- Quantity Slider -->
          <div class="dual-range-slider" id="qty-slider-container">
            <div class="slider-track">
              <div class="slider-range" id="qty-slider-range"></div>
            </div>
            <input type="range" class="slider-thumb slider-thumb-min" id="qty-slider-min" min="0" max="1000" value="0" step="1">
            <input type="range" class="slider-thumb slider-thumb-max" id="qty-slider-max" min="0" max="1000" value="1000" step="1">
          </div>
          
          <!-- Min Quantity Input -->
          <div class="filter-range-inputs compact">
            <div class="filter-input-group full-width">
              <label>Minimum Available</label>
              <input type="number" id="min-quantity-input" value="0" min="0" placeholder="0">
            </div>
          </div>
        </div>

        <!-- Weight Range with Slider -->
        <div class="filter-section filter-section-enhanced">
          <div class="filter-section-header">
            <h4 class="filter-section-title">
              <i data-lucide="weight"></i>
              Weight
            </h4>
            <span class="filter-section-unit">kg</span>
          </div>
          
          <!-- Weight Range Display -->
          <div class="filter-range-display">
            <span class="range-value-min" id="weight-range-min-display">0</span>
            <span class="range-separator">—</span>
            <span class="range-value-max" id="weight-range-max-display">100</span>
          </div>
          
          <!-- Weight Slider -->
          <div class="dual-range-slider" id="weight-slider-container">
            <div class="slider-track">
              <div class="slider-range" id="weight-slider-range"></div>
            </div>
            <input type="range" class="slider-thumb slider-thumb-min" id="weight-slider-min" min="0" max="100" value="0" step="0.1">
            <input type="range" class="slider-thumb slider-thumb-max" id="weight-slider-max" min="0" max="100" value="100" step="0.1">
          </div>
          
          <!-- Weight Inputs -->
          <div class="filter-range-inputs compact">
            <div class="filter-input-group">
              <label>Min</label>
              <input type="number" id="min-weight-input" value="0" min="0" step="0.1" placeholder="0">
            </div>
            <span class="filter-range-separator">–</span>
            <div class="filter-input-group">
              <label>Max</label>
              <input type="number" id="max-weight-input" value="100" min="0" step="0.1" placeholder="100">
            </div>
          </div>
        </div>
      </div>

      <!-- Filter Footer with Results Preview -->
      <div class="filters-footer">
        <div class="filter-results-preview">
          <span class="preview-label">Matching:</span>
          <span class="preview-count" id="filter-preview-count">0</span>
          <span class="preview-label">parts</span>
        </div>
        <div class="filter-footer-actions">
          <button class="filter-btn-clear" id="clear-filters">
            <i data-lucide="rotate-ccw"></i>
            Reset
          </button>
          <button class="filter-btn-apply" id="apply-filters">
            <i data-lucide="check"></i>
            Apply Filters
          </button>
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <div class="search-results-main">
      <!-- Results Header -->
      <div class="results-header" id="results-header" style="display: none;">
        <div class="results-header-left">
        <p class="results-count">
          Found <strong id="results-count">0</strong> parts matching your search
          <span class="results-page-info" id="results-page-info" style="display: none;"></span>
        </p>
        <p class="results-subtitle">
          <span id="selection-status">Select items to add to cart</span>
          <span class="selected-badge" id="selected-badge" style="display: none;">
            <i data-lucide="shopping-cart"></i>
            <span id="selected-items-count">0</span> Selected
          </span>
        </p>
        </div>
        <div class="results-header-right">
        <div class="selected-total-box">
          <span class="selected-total-label">Selected Total</span>
          <span class="selected-total-amount" id="selected-total">0.00 AED</span>
          </div>
          <!-- Add to Cart Button in Header -->
          <button class="btn-add-to-cart-header" id="add-to-cart-btn-header" disabled>
            <i data-lucide="shopping-cart"></i>
            <span>Add to Cart (<span id="selected-count-header">0</span>)</span>
          </button>
          <button class="filter-toggle-btn" id="mobile-filter-toggle">
            <i data-lucide="sliders-horizontal"></i>
            <span>Filters</span>
          </button>
        </div>
      </div>

      <!-- Quick Sort & Filter Bar -->
      <div class="quick-sort-bar" id="quick-sort-bar" style="display: none;">
        <div class="quick-sort-left">
          <span class="quick-sort-label">Sort by:</span>
          <div class="quick-sort-buttons">
            <button class="quick-sort-btn active" data-sort="relevance" data-order="desc">
              <i data-lucide="sparkles"></i>
              <span>Relevance</span>
            </button>
            <button class="quick-sort-btn" data-sort="price" data-order="asc">
              <i data-lucide="arrow-down-narrow-wide"></i>
              <span>Cheapest</span>
            </button>
            <button class="quick-sort-btn" data-sort="price" data-order="desc">
              <i data-lucide="arrow-up-narrow-wide"></i>
              <span>Expensive</span>
            </button>
            <button class="quick-sort-btn" data-sort="deliveryDays" data-order="asc">
              <i data-lucide="zap"></i>
              <span>Fastest Delivery</span>
            </button>
            <button class="quick-sort-btn" data-sort="quantity" data-order="desc">
              <i data-lucide="package-check"></i>
              <span>Most Stock</span>
            </button>
          </div>
        </div>
        <div class="quick-sort-right">
          <button class="quick-filter-btn" data-filter="in-stock">
            <span class="stock-dot green"></span>
            In Stock Only
          </button>
          <button class="quick-filter-btn" data-filter="low-stock">
            <span class="stock-dot yellow"></span>
            Low Stock
          </button>
        </div>
      </div>

      <!-- Results Table -->
      <div class="results-table-container" id="results-table-container" style="display: none;">
        <div class="table-wrapper">
          <table class="results-table" id="results-table">
            <thead>
              <tr>
                <th>SELECT</th>
                <th>BRAND</th>
                <th>VENDOR CODE</th>
                <th>DESCRIPTION</th>
                <th>QTY</th>
                <th>STOCK CODE</th>
                <th>VOLUME</th>
                <th>WEIGHT</th>
                <th>DELIVERY</th>
                <th>ORDER QTY</th>
                <th>TOTAL</th>
                <th>-</th>
              </tr>
            </thead>
            <tbody id="results-table-body">
              <!-- Results will be inserted here -->
            </tbody>
          </table>
        </div>

        <!-- Pagination Controls -->
        <div class="results-pagination" id="results-pagination" style="display: none;">
          <!-- Populated by JS -->
        </div>

        <!-- Results Footer -->
        <div class="results-footer">
          <div class="results-footer-left">
            <button class="btn-add-to-cart" id="add-to-cart-btn" disabled>
              <i data-lucide="shopping-cart"></i>
            Add Selected to Cart (<span id="selected-count">0</span>)
          </button>
          </div>
          <div class="selected-total-footer">
            <span class="selected-total-label-footer">SELECTED TOTAL:</span>
            <span class="selected-total-amount-footer" id="selected-total-footer">0.00 AED</span>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div class="empty-state" id="empty-state">
        <div class="empty-state-icon-wrapper">
          <i data-lucide="search" class="empty-state-icon"></i>
        </div>
        <h3 class="empty-state-title">Start Your Search</h3>
        <p class="empty-state-description">
          Enter a part number, brand name, or description to find parts from verified suppliers worldwide.
        </p>

        <!-- Popular Searches -->
        <div class="popular-searches">
          <h4 class="popular-searches-title">Popular Searches</h4>
          <div class="popular-chips">
            <button class="popular-chip" data-search="8471474">
              <i data-lucide="trending-up"></i>
              8471474
            </button>
            <button class="popular-chip" data-search="brake pads">
              <i data-lucide="circle-stop"></i>
              Brake Pads
            </button>
            <button class="popular-chip" data-search="oil filter">
              <i data-lucide="filter"></i>
              Oil Filter
            </button>
            <button class="popular-chip" data-search="alternator">
              <i data-lucide="zap"></i>
              Alternator
            </button>
            <button class="popular-chip" data-search="water pump">
              <i data-lucide="droplets"></i>
              Water Pump
            </button>
          </div>
        </div>

        <!-- Feature Highlights -->
        <div class="empty-state-features">
          <div class="feature-item">
            <i data-lucide="shield-check"></i>
            <span>Verified Suppliers</span>
          </div>
          <div class="feature-item">
            <i data-lucide="globe"></i>
            <span>Global Network</span>
          </div>
          <div class="feature-item">
            <i data-lucide="zap"></i>
            <span>Fast Delivery</span>
          </div>
          <div class="feature-item">
            <i data-lucide="award"></i>
            <span>Quality Guaranteed</span>
          </div>
        </div>
      </div>

      <!-- No Results State -->
      <div class="empty-state" id="no-results-state" style="display: none;">
        <div class="empty-state-icon-wrapper">
          <i data-lucide="package-x" class="empty-state-icon"></i>
        </div>
        <h3 class="empty-state-title">No Parts Found</h3>
        <p class="empty-state-description">
          We couldn't find any parts matching "<strong id="no-results-query"></strong>".
          Try a different part number or contact our team for assistance.
        </p>

        <div class="no-results-actions">
          <button class="btn-try-again" id="try-again-btn">
            <i data-lucide="refresh-cw"></i>
            Try Again
          </button>
          <button class="btn-contact-support">
            <i data-lucide="message-circle"></i>
            Contact Support
          </button>
        </div>

        <!-- Suggestions -->
        <div class="no-results-suggestions">
          <h4>Suggestions:</h4>
          <ul>
            <li>Check the spelling of your search term</li>
            <li>Try using a different part number format</li>
            <li>Use fewer or more general keywords</li>
            <li>Clear filters to broaden your search</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- AI-Powered Excel Upload Modal -->
<div class="modal ai-excel-modal" id="excel-modal">
  <div class="modal-overlay" id="excel-modal-overlay"></div>
  <div class="modal-container ai-excel-container">
    <!-- Modal Header -->
    <div class="modal-header ai-excel-header">
      <div class="ai-excel-title-wrapper">
        <div class="ai-excel-icon">
          <i data-lucide="file-spreadsheet"></i>
        </div>
        <div class="ai-excel-title-content">
          <h3 class="modal-title">
            Excel Import
            <span class="ai-badge">AI</span>
          </h3>
          <p class="ai-excel-subtitle">AI analyzes your spreadsheet to extract parts automatically</p>
        </div>
      </div>
      <button class="modal-close" id="excel-modal-close">
        <i data-lucide="x"></i>
      </button>
    </div>

    <div class="modal-body ai-excel-body">
      <!-- Step 1: Upload Area -->
      <div class="ai-excel-step" id="excel-step-upload">
        <!-- Upload Error Banner -->
        <div class="ai-upload-error" id="upload-error-banner" style="display: none;">
          <div class="upload-error-icon">
            <i data-lucide="alert-triangle"></i>
          </div>
          <div class="upload-error-content">
            <h4 class="upload-error-title" id="upload-error-title">File Too Large</h4>
            <p class="upload-error-message" id="upload-error-message"></p>
            <div class="upload-error-details" id="upload-error-details"></div>
          </div>
          <button class="upload-error-dismiss" id="upload-error-dismiss">
            <i data-lucide="x"></i>
          </button>
        </div>

        <div class="upload-area ai-upload-area" id="upload-area">
          <input type="file" id="excel-file-input" accept=".xlsx,.xls,.csv" hidden>
          <div class="ai-upload-visual">
            <div class="ai-upload-icon-wrapper">
              <div class="ai-upload-glow"></div>
              <i data-lucide="upload-cloud"></i>
            </div>
            <div class="ai-upload-sparkles">
              <i data-lucide="sparkles" class="sparkle s1"></i>
              <i data-lucide="sparkles" class="sparkle s2"></i>
              <i data-lucide="sparkles" class="sparkle s3"></i>
            </div>
          </div>
          
          <h4 class="upload-title">Drag & drop your Excel file</h4>
          <p class="upload-subtitle">AI will intelligently extract parts from any format</p>
          
          <button class="btn-primary ai-browse-btn" id="browse-file-btn">
            <i data-lucide="folder-open"></i>
            <span>Browse Files</span>
          </button>
          
          <p class="upload-hint">
            <i data-lucide="check-circle"></i>
            Supports .xlsx, .xls, .csv • Max 10MB • Max 5,000 rows • Max 1,000 parts per search
          </p>
        </div>

        <div class="sample-format ai-sample-format">
          <div class="sample-header">
            <i data-lucide="info"></i>
            <span>Works with any format, but structured data gives better results</span>
          </div>
          <a href="/api/download-sample-excel" class="download-sample" download>
            <i data-lucide="download"></i>
            <span>Download Sample Template</span>
          </a>
        </div>
      </div>

      <!-- Step 2: AI Analyzing -->
      <div class="ai-excel-step" id="excel-step-analyzing" style="display: none;">
        <div class="ai-analyzing-container">
          <div class="ai-analyzing-visual">
            <div class="ai-brain-pulse">
              <i data-lucide="brain"></i>
            </div>
            <div class="ai-analyzing-rings">
              <div class="ring r1"></div>
              <div class="ring r2"></div>
              <div class="ring r3"></div>
            </div>
          </div>
          
          <div class="ai-analyzing-content">
            <h4 class="ai-analyzing-title">AI is analyzing your spreadsheet...</h4>
            <p class="ai-analyzing-file" id="analyzing-file-name">processing file.xlsx</p>
            
            <div class="ai-analyzing-steps">
              <div class="ai-step" id="ai-step-reading">
                <div class="ai-step-icon"><i data-lucide="file-search"></i></div>
                <span>Reading spreadsheet data</span>
                <div class="ai-step-status"><i data-lucide="loader-2" class="spin"></i></div>
              </div>
              <div class="ai-step" id="ai-step-detecting">
                <div class="ai-step-icon"><i data-lucide="scan-search"></i></div>
                <span>Detecting part numbers</span>
                <div class="ai-step-status"></div>
              </div>
              <div class="ai-step" id="ai-step-extracting">
                <div class="ai-step-icon"><i data-lucide="wand-2"></i></div>
                <span>Extracting quantities & brands</span>
                <div class="ai-step-status"></div>
              </div>
              <div class="ai-step" id="ai-step-validating">
                <div class="ai-step-icon"><i data-lucide="check-circle"></i></div>
                <span>Validating & organizing</span>
                <div class="ai-step-status"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: AI Results Preview -->
      <div class="ai-excel-step" id="excel-step-results" style="display: none;">
        <!-- AI Summary Banner -->
        <div class="ai-results-summary">
          <div class="ai-summary-icon">
            <i data-lucide="sparkles"></i>
          </div>
          <div class="ai-summary-content">
            <h4 class="ai-summary-title" id="ai-summary-title">Analysis Complete!</h4>
            <p class="ai-summary-text" id="ai-summary-text">Found 25 parts ready for search</p>
          </div>
          <div class="ai-summary-badge" id="ai-summary-badge">
            <i data-lucide="zap"></i>
            <span>AI Powered</span>
          </div>
        </div>

        <!-- Data Quality Indicator -->
        <div class="ai-data-quality" id="ai-data-quality">
          <div class="quality-meter">
            <div class="quality-label">Data Quality:</div>
            <div class="quality-bar">
              <div class="quality-fill" id="quality-fill"></div>
            </div>
            <div class="quality-text" id="quality-text">Good</div>
          </div>
          <div class="quality-issues" id="quality-issues" style="display: none;">
            <i data-lucide="alert-circle"></i>
            <span id="quality-issues-text"></span>
          </div>
        </div>

        <!-- Parts List Header -->
        <div class="ai-parts-header">
          <div class="parts-header-left">
            <label class="select-all-checkbox">
              <input type="checkbox" id="select-all-parts" checked>
              <span class="checkbox-custom"></span>
              <span class="checkbox-label">Select All</span>
            </label>
            <label class="select-all-checkbox select-first-option" id="select-first-1000-label" style="display: none;">
              <input type="checkbox" id="select-first-1000">
              <span class="checkbox-custom"></span>
              <span class="checkbox-label">Select First 1,000</span>
            </label>
            <span class="parts-count" id="parts-count">0 parts selected</span>
          </div>
          <div class="parts-header-right">
            <div class="parts-filter">
              <button class="filter-btn active" data-filter="all">All</button>
              <button class="filter-btn" data-filter="high">High Confidence</button>
              <button class="filter-btn" data-filter="medium">Medium</button>
              <button class="filter-btn" data-filter="low">Low</button>
            </div>
          </div>
        </div>

        <!-- Parts List -->
        <div class="ai-parts-list" id="ai-parts-list">
          <!-- Parts will be dynamically inserted here -->
        </div>

        <!-- AI Suggestions -->
        <div class="ai-suggestions" id="ai-suggestions" style="display: none;">
          <div class="suggestions-header">
            <i data-lucide="lightbulb"></i>
            <span>AI Suggestions</span>
          </div>
          <ul class="suggestions-list" id="suggestions-list">
          </ul>
        </div>
      </div>

      <!-- Step 4: Search Results with Recommendations -->
      <div class="ai-excel-step" id="excel-step-search-results" style="display: none;">
        <!-- Analytics Summary -->
        <div class="excel-analytics" id="excel-analytics">
          <div class="analytics-header">
            <h4>Import Analytics</h4>
            <span class="analytics-filename" id="analytics-filename">file.xlsx</span>
          </div>
          
          <!-- Stats Cards -->
          <div class="analytics-stats">
            <div class="stat-card stat-total">
              <div class="stat-icon">
                <i data-lucide="file-spreadsheet"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value" id="stat-total">0</div>
                <div class="stat-label">Total Parts</div>
              </div>
            </div>
            <div class="stat-card stat-found">
              <div class="stat-icon">
                <i data-lucide="check-circle"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value" id="stat-found">0</div>
                <div class="stat-label">Found</div>
              </div>
              <div class="stat-percent stat-percent-found" id="stat-percent-found">0%</div>
            </div>
            <div class="stat-card stat-not-found">
              <div class="stat-icon">
                <i data-lucide="x-circle"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value" id="stat-not-found">0</div>
                <div class="stat-label">Not Found</div>
              </div>
              <div class="stat-percent stat-percent-not-found" id="stat-percent-not-found">0%</div>
            </div>
            <div class="stat-card stat-duplicates" id="stat-duplicates-card" style="display: none;">
              <div class="stat-icon">
                <i data-lucide="copy"></i>
              </div>
              <div class="stat-content">
                <div class="stat-value" id="stat-duplicates">0</div>
                <div class="stat-label">Duplicates</div>
              </div>
              <div class="stat-note">Not counted</div>
            </div>
          </div>
          
          <!-- Success Rate Bar -->
          <div class="success-rate-container">
            <div class="success-rate-header">
              <span class="success-rate-label">Success Rate</span>
              <span class="success-rate-value" id="success-rate-value">0%</span>
            </div>
            <div class="success-rate-bar">
              <div class="success-rate-fill" id="success-rate-fill" style="width: 0%;"></div>
            </div>
          </div>
          
          <!-- Not Found Parts List -->
          <div class="not-found-section" id="not-found-section" style="display: none;">
            <div class="not-found-header">
              <i data-lucide="alert-triangle"></i>
              <span>Parts Not Found</span>
              <button class="not-found-toggle" id="not-found-toggle">
                <i data-lucide="chevron-down"></i>
              </button>
            </div>
            <div class="not-found-list" id="not-found-list">
              <!-- Not found parts will be listed here -->
            </div>
          </div>
          
          <!-- Duplicates Warning -->
          <div class="duplicates-section" id="duplicates-section" style="display: none;">
            <div class="duplicates-header">
              <i data-lucide="info"></i>
              <span>Duplicate parts detected and merged</span>
              <button class="duplicates-toggle" id="duplicates-toggle">
                <i data-lucide="chevron-down"></i>
              </button>
            </div>
            <div class="duplicates-list" id="duplicates-list">
              <!-- Duplicates will be listed here -->
            </div>
          </div>
        </div>

        <div class="ai-search-header">
          <div class="search-header-left">
            <h4>Search Results & AI Recommendations</h4>
            <p class="search-summary" id="search-summary">Found options for 25 parts</p>
          </div>
          <div class="search-header-right">
            <button class="btn-secondary" id="back-to-parts-btn">
              <i data-lucide="arrow-left"></i>
              <span>Back to Parts</span>
            </button>
          </div>
        </div>

        <!-- Recommendations List -->
        <div class="ai-recommendations-list" id="ai-recommendations-list">
          <!-- Recommendations will be dynamically inserted here -->
        </div>
      </div>
    </div>

    <!-- Modal Footer -->
    <div class="modal-footer ai-excel-footer">
      <div class="footer-left">
        <button class="btn-secondary" id="excel-reset-btn" style="display: none;">
          <i data-lucide="rotate-ccw"></i>
          <span>Upload New File</span>
        </button>
      </div>
      <div class="footer-right">
        <button class="btn-secondary" id="excel-cancel-btn">
          Cancel
        </button>
        <button class="btn-primary ai-search-btn" id="excel-search-btn" style="display: none;">
          <i data-lucide="search"></i>
          <span>Search Parts</span>
          <span class="search-count" id="excel-search-count">0</span>
        </button>
        <button class="btn-primary ai-cart-btn" id="excel-add-cart-btn" style="display: none;">
          <i data-lucide="shopping-cart"></i>
          <span>Add to Cart</span>
          <span class="cart-count" id="excel-cart-count">0</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Recent Searches Modal -->
<div class="modal" id="recent-searches-modal">
  <div class="modal-overlay" id="recent-searches-overlay"></div>
  <div class="modal-container modal-sm">
    <div class="modal-header">
      <h3 class="modal-title">
        <i data-lucide="clock"></i>
        <span>Recent Searches</span>
      </h3>
      <button class="modal-close" id="recent-searches-close">
        <i data-lucide="x"></i>
      </button>
    </div>
    <div class="modal-body">
      <div class="recent-searches-list" id="recent-searches-list">
        <!-- Recent searches will be populated here -->
        <div class="recent-search-empty">
          <i data-lucide="search"></i>
          <p>No recent searches yet</p>
        </div>
      </div>
      <button class="btn-clear-history" id="clear-search-history" style="display: none;">
        <i data-lucide="trash-2"></i>
        Clear History
      </button>
    </div>
  </div>
</div>

<style>
/* Additional styles for enhanced filter sidebar */
.filter-search {
  position: relative;
  margin-bottom: 0.75rem;
}

.filter-search i {
  position: absolute;
  left: 0.875rem;
  top: 50%;
  transform: translateY(-50%);
  width: 16px;
  height: 16px;
  color: var(--text-muted);
}

.filter-search input {
  width: 100%;
  padding: 0.75rem 1rem 0.75rem 2.5rem;
  background: var(--bg-secondary);
  border: 1.5px solid var(--border-color);
  border-radius: 0.5rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.875rem;
  color: var(--text-primary);
  outline: none;
  transition: all 0.2s ease;
}

.filter-search input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.filter-tags.scrollable {
  max-height: 200px;
  overflow-y: auto;
  padding-right: 0.5rem;
}

.filter-tags.scrollable::-webkit-scrollbar {
  width: 4px;
}

.filter-tags.scrollable::-webkit-scrollbar-track {
  background: var(--bg-secondary);
  border-radius: 2px;
}

.filter-tags.scrollable::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

.filter-tag i {
  width: 14px;
  height: 14px;
  margin-right: 4px;
}

.stock-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  display: inline-block;
  margin-right: 6px;
}

.stock-indicator.green {
  background: #22c55e;
  box-shadow: 0 0 6px rgba(34, 197, 94, 0.5);
}

.stock-indicator.yellow {
  background: #f59e0b;
  box-shadow: 0 0 6px rgba(245, 158, 11, 0.5);
}

.stock-indicator.red {
  background: #ef4444;
  box-shadow: 0 0 6px rgba(239, 68, 68, 0.5);
}

.filter-toggle {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  cursor: pointer;
}

.filter-toggle input {
  display: none;
}

.filter-toggle .toggle-slider {
  position: relative;
  width: 44px;
  height: 24px;
  background: var(--border-color);
  border-radius: 12px;
  transition: all 0.3s ease;
  flex-shrink: 0;
}

.filter-toggle .toggle-slider::before {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 20px;
  height: 20px;
  background: #fff;
  border-radius: 50%;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
}

.filter-toggle input:checked + .toggle-slider {
  background: var(--primary);
}

.filter-toggle input:checked + .toggle-slider::before {
  transform: translateX(20px);
}

.filter-toggle .toggle-label {
  font-family: 'Inter', sans-serif;
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.active-filters-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  background: rgba(59, 130, 246, 0.05);
  border: 1px solid rgba(59, 130, 246, 0.15);
  border-radius: 0.5rem;
  margin-bottom: 1.5rem;
}

.active-filters-list {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.active-filter-chip {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.375rem 0.75rem;
  background: var(--primary);
  border-radius: 1rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.75rem;
  font-weight: 500;
  color: #fff;
}

.active-filter-chip button {
  width: 14px;
  height: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.2);
  border: none;
  border-radius: 50%;
  color: #fff;
  cursor: pointer;
  margin-left: 0.25rem;
}

.clear-active-filters {
  display: flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.375rem 0.75rem;
  background: transparent;
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: 0.375rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.75rem;
  font-weight: 500;
  color: #ef4444;
  cursor: pointer;
  transition: all 0.2s ease;
}

.clear-active-filters:hover {
  background: rgba(239, 68, 68, 0.1);
}

.clear-active-filters i {
  width: 12px;
  height: 12px;
}

.filter-group-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.filter-group-title i {
  width: 16px;
  height: 16px;
  color: var(--primary);
}

.results-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.results-header-left {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.results-header-right {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.filter-toggle-btn {
  display: none;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.25rem;
  background: var(--bg-secondary);
  border: 1.5px solid var(--border-color);
  border-radius: 0.5rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-toggle-btn:hover {
  border-color: var(--primary);
  color: var(--primary);
}

.filter-toggle-btn i {
  width: 16px;
  height: 16px;
}

.results-footer-left {
  display: flex;
  gap: 1rem;
}

.no-results-actions {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin-top: 2rem;
}

.btn-try-again,
.btn-contact-support {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.875rem 1.5rem;
  border-radius: 0.5rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.9375rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-try-again {
  background: var(--primary);
  border: none;
  color: #fff;
}

.btn-try-again:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}

.btn-contact-support {
  background: transparent;
  border: 1.5px solid var(--border-color);
  color: var(--text-primary);
}

.btn-contact-support:hover {
  border-color: var(--primary);
  color: var(--primary);
}

.btn-try-again i,
.btn-contact-support i {
  width: 18px;
  height: 18px;
}

.no-results-suggestions {
  margin-top: 2rem;
  text-align: left;
  max-width: 400px;
  margin-left: auto;
  margin-right: auto;
}

.no-results-suggestions h4 {
  font-family: 'Inter', sans-serif;
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 0.75rem;
}

.no-results-suggestions ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.no-results-suggestions li {
  padding: 0.5rem 0;
  padding-left: 1.5rem;
  position: relative;
  font-family: 'Inter', sans-serif;
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.no-results-suggestions li::before {
  content: '•';
  position: absolute;
  left: 0;
  color: var(--primary);
}

.modal-sm {
  max-width: 480px;
}

.recent-searches-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.recent-search-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.875rem 1rem;
  background: var(--bg-secondary);
  border-radius: 0.5rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.recent-search-item:hover {
  background: rgba(59, 130, 246, 0.08);
}

.recent-search-item-content {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.recent-search-item-content i {
  width: 16px;
  height: 16px;
  color: var(--text-muted);
}

.recent-search-item-text {
  font-family: 'Inter', sans-serif;
  font-size: 0.9375rem;
  color: var(--text-primary);
}

.recent-search-item-time {
  font-family: 'Inter', sans-serif;
  font-size: 0.75rem;
  color: var(--text-muted);
}

.recent-search-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.75rem;
  padding: 2rem;
  text-align: center;
}

.recent-search-empty i {
  width: 32px;
  height: 32px;
  color: var(--text-muted);
}

.recent-search-empty p {
  font-family: 'Inter', sans-serif;
  font-size: 0.9375rem;
  color: var(--text-muted);
  margin: 0;
}

/* Excel Recent Search Styles */
.recent-search-excel {
  padding: 0 !important;
  background: transparent !important;
  flex-direction: column;
  gap: 0;
}

.recent-search-excel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.875rem 1rem;
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.08) 0%, rgba(59, 130, 246, 0.08) 100%);
  border-radius: 0.5rem 0.5rem 0 0;
  border-bottom: 1px solid var(--border-color);
}

.recent-search-excel-header .recent-search-item-content {
  gap: 0.75rem;
}

.recent-search-excel-header .recent-search-item-content i {
  color: #22c55e;
}

.recent-search-excel-actions {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.recent-search-all-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.375rem 0.75rem;
  background: var(--primary);
  border: none;
  border-radius: 0.375rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.75rem;
  font-weight: 600;
  color: white;
  cursor: pointer;
  transition: all 0.2s ease;
}

.recent-search-all-btn:hover {
  background: var(--primary-dark);
  transform: translateY(-1px);
}

.recent-search-all-btn i {
  width: 12px;
  height: 12px;
}

.recent-search-parts-list {
  display: flex;
  flex-direction: column;
  max-height: 200px;
  overflow-y: auto;
  background: var(--bg-secondary);
  border-radius: 0 0 0.5rem 0.5rem;
}

.recent-search-parts-list::-webkit-scrollbar {
  width: 4px;
}

.recent-search-parts-list::-webkit-scrollbar-track {
  background: transparent;
}

.recent-search-parts-list::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

.recent-part-number {
  display: flex;
  align-items: center;
  gap: 0.625rem;
  padding: 0.625rem 1rem;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  cursor: pointer;
  transition: all 0.15s ease;
}

.recent-part-number:last-child {
  border-bottom: none;
}

.recent-part-number:hover {
  background: rgba(59, 130, 246, 0.06);
}

.recent-part-number i {
  width: 14px;
  height: 14px;
  color: var(--text-muted);
  flex-shrink: 0;
}

.recent-part-number span {
  flex: 1;
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  font-size: 0.8125rem;
  color: var(--text-primary);
  font-weight: 500;
}

.recent-part-search-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: transparent;
  border: 1px solid var(--border-color);
  border-radius: 0.25rem;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
  opacity: 0;
}

.recent-part-number:hover .recent-part-search-btn {
  opacity: 1;
}

.recent-part-search-btn:hover {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
}

.recent-part-search-btn i {
  width: 12px;
  height: 12px;
  color: inherit;
}

.btn-clear-history {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  width: 100%;
  padding: 0.875rem;
  background: transparent;
  border: 1.5px solid rgba(239, 68, 68, 0.3);
  border-radius: 0.5rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.875rem;
  font-weight: 600;
  color: #ef4444;
  cursor: pointer;
  transition: all 0.2s ease;
  margin-top: 1rem;
}

.btn-clear-history:hover {
  background: rgba(239, 68, 68, 0.1);
}

.btn-clear-history i {
  width: 16px;
  height: 16px;
}

/* Make modal wider for Excel searches */
.modal-container.modal-sm {
  max-width: 480px;
}

@media (max-width: 1199px) {
  .filter-toggle-btn {
    display: flex;
  }
}

@media (max-width: 767px) {
  .results-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }
  
  .results-header-right {
    width: 100%;
    justify-content: space-between;
  }
  
  .results-footer-left {
    flex-direction: column;
    width: 100%;
  }
  
  .btn-add-to-cart {
    width: 100%;
    justify-content: center;
  }
  
  .no-results-actions {
    flex-direction: column;
  }
  
  .btn-try-again,
  .btn-contact-support {
    width: 100%;
    justify-content: center;
  }
}

/* ====================================
   QUICK SORT BAR STYLES
   ==================================== */
.quick-sort-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  padding: 0.875rem 1.25rem;
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.04) 0%, rgba(99, 102, 241, 0.04) 100%);
  border: 1px solid rgba(59, 130, 246, 0.12);
  border-radius: 0.75rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.quick-sort-left {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.quick-sort-label {
  font-family: 'Inter', sans-serif;
  font-size: 0.8125rem;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.quick-sort-buttons {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.quick-sort-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.5rem 0.875rem;
  background: white;
  border: 1.5px solid var(--border-color);
  border-radius: 2rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.quick-sort-btn i {
  width: 14px;
  height: 14px;
}

.quick-sort-btn:hover {
  border-color: var(--primary);
  color: var(--primary);
  background: rgba(59, 130, 246, 0.04);
}

.quick-sort-btn.active {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.25);
}

.quick-sort-btn.active:hover {
  background: var(--primary-dark);
  border-color: var(--primary-dark);
  color: white;
}

.quick-sort-right {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.quick-filter-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.5rem 0.875rem;
  background: white;
  border: 1.5px solid var(--border-color);
  border-radius: 2rem;
  font-family: 'Inter', sans-serif;
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.quick-filter-btn i {
  width: 14px;
  height: 14px;
}

.quick-filter-btn .stock-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #22c55e;
  box-shadow: 0 0 6px rgba(34, 197, 94, 0.4);
}

.quick-filter-btn:hover {
  border-color: var(--primary);
  color: var(--primary);
  background: rgba(59, 130, 246, 0.04);
}

.quick-filter-btn.active {
  background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
  border-color: #22c55e;
  color: white;
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.25);
}

.quick-filter-btn.active .stock-dot {
  background: white;
  box-shadow: none;
}

.quick-filter-btn.active:hover {
  background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
}

/* Low Stock button active state */
.quick-filter-btn[data-filter="low-stock"].active {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  border-color: #f59e0b;
}

.quick-filter-btn[data-filter="low-stock"].active:hover {
  background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
}

/* ====================================
   ENHANCED FILTERS SIDEBAR STYLES
   ==================================== */
.filters-sidebar {
  width: 420px;
  min-width: 420px;
}

@media (max-width: 1199px) {
  .filters-sidebar {
    width: 400px;
    max-width: 90vw;
  }
}

/* Dynamic brand tags from data */
.filter-tags-dynamic {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  max-height: 180px;
  overflow-y: auto;
  padding-right: 0.5rem;
}

.filter-tags-dynamic::-webkit-scrollbar {
  width: 4px;
}

.filter-tags-dynamic::-webkit-scrollbar-track {
  background: var(--bg-secondary);
  border-radius: 2px;
}

.filter-tags-dynamic::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

/* Quick Sort responsive */
@media (max-width: 991px) {
  .quick-sort-bar {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }
  
  .quick-sort-left,
  .quick-sort-right {
    width: 100%;
  }
  
  .quick-sort-buttons {
    width: 100%;
  }
}

@media (max-width: 575px) {
  .quick-sort-btn span {
    display: none;
  }
  
  .quick-sort-btn {
    padding: 0.625rem;
  }
  
  .quick-sort-btn i {
    width: 16px;
    height: 16px;
  }
  
  .quick-filter-btn span {
    display: none;
  }
  
  .quick-filter-btn {
    padding: 0.625rem;
  }
}
</style>