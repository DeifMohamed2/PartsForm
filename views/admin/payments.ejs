<%- include('partials/header') %>
<link rel="stylesheet" href="/css/adminCSS/admin-dashboard.css">
</head>
<body class="<%= typeof currentModule !== 'undefined' && currentModule ? 'module-' + currentModule : '' %>">
  <div class="admin-wrapper">
    <%- include('partials/sidebar', { activePage: 'payments', currentModule: currentModule }) %>
    
    <main class="admin-main">
      <%- include('partials/topbar', { pageTitle: 'Payments', currentModule: currentModule }) %>
      
      <div class="admin-content">
        <% if (currentModule && moduleConfig) { %>
        <div class="module-info-banner">
          <div class="module-info-icon">
            <i data-lucide="<%= moduleConfig.icon %>"></i>
          </div>
          <div class="module-info-content">
            <div class="module-info-title"><%= moduleConfig.name %> Payments</div>
            <div class="module-info-desc">Viewing <%= moduleConfig.name.toLowerCase() %> payment transactions</div>
          </div>
          <div class="module-info-stats">
            <div class="module-info-stat">
              <div class="module-info-stat-value"><%= payments.length %></div>
              <div class="module-info-stat-label">Payments</div>
            </div>
            <div class="module-info-stat">
              <div class="module-info-stat-value">$<%= (payments.reduce((s, p) => s + p.amount, 0) / 1000).toFixed(0) %>K</div>
              <div class="module-info-stat-label">Total</div>
            </div>
          </div>
        </div>
        <% } %>

        <div class="page-header">
          <h2><%= currentModule ? moduleConfig.name + ' Payments' : 'Payments Management' %></h2>
          <button class="admin-btn admin-btn-primary">
            <i data-lucide="plus"></i>
            Record Payment
          </button>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid" style="margin-bottom: 2rem;">
          <div class="stat-card green">
            <div class="stat-icon">
              <i data-lucide="check-circle"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value"><%= payments.filter(p => p.status === 'completed').length %></div>
              <div class="stat-label">Completed</div>
            </div>
          </div>
          <div class="stat-card module-themed">
            <div class="stat-icon">
              <i data-lucide="loader"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value"><%= payments.filter(p => p.status === 'processing').length %></div>
              <div class="stat-label">Processing</div>
            </div>
          </div>
          <div class="stat-card orange">
            <div class="stat-icon">
              <i data-lucide="clock"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value"><%= payments.filter(p => p.status === 'pending').length %></div>
              <div class="stat-label">Pending</div>
            </div>
          </div>
          <div class="stat-card purple">
            <div class="stat-icon">
              <i data-lucide="dollar-sign"></i>
            </div>
            <div class="stat-content">
              <div class="stat-value">$<%= (payments.reduce((s, p) => s + p.amount, 0) / 1000).toFixed(0) %>K</div>
              <div class="stat-label">Total Value</div>
            </div>
          </div>
        </div>

        <!-- Filters -->
        <div class="filters-row">
          <div class="filter-group">
            <span class="filter-label">Status:</span>
            <select class="filter-select">
              <option value="">All Status</option>
              <option value="completed">Completed</option>
              <option value="processing">Processing</option>
              <option value="pending">Pending</option>
            </select>
          </div>
          <div class="filter-group">
            <span class="filter-label">Method:</span>
            <select class="filter-select">
              <option value="">All Methods</option>
              <option value="wire">Wire Transfer</option>
              <option value="credit_card">Credit Card</option>
              <option value="letter_of_credit">Letter of Credit</option>
            </select>
          </div>
          <div class="filter-search">
            <i data-lucide="search"></i>
            <input type="text" placeholder="Search payments...">
          </div>
        </div>

        <!-- Payments Table -->
        <div class="orders-card">
          <div class="orders-body">
            <div class="order-row" style="background: var(--admin-bg-tertiary); font-weight: 600; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--admin-text-muted);">
              <div>Payment ID</div>
              <div>Customer</div>
              <div>Amount</div>
              <div>Method</div>
              <div>Status</div>
              <div>Actions</div>
            </div>
            <% payments.forEach(payment => { %>
              <div class="order-row">
                <div class="order-id"><%= payment.id %></div>
                <div class="order-customer"><%= payment.customer %></div>
                <div class="order-amount">$<%= payment.amount.toLocaleString() %></div>
                <div style="color: var(--admin-text-secondary);">
                  <% if (payment.method === 'wire') { %>
                    Wire Transfer
                  <% } else if (payment.method === 'credit_card') { %>
                    Credit Card
                  <% } else { %>
                    Letter of Credit
                  <% } %>
                </div>
                <div class="order-status <%= payment.status === 'completed' ? 'delivered' : payment.status %>">
                  <% if (payment.status === 'completed') { %>
                    <i data-lucide="check-circle" style="width: 12px; height: 12px;"></i>
                  <% } else if (payment.status === 'processing') { %>
                    <i data-lucide="loader" style="width: 12px; height: 12px;"></i>
                  <% } else { %>
                    <i data-lucide="clock" style="width: 12px; height: 12px;"></i>
                  <% } %>
                  <%= payment.status.charAt(0).toUpperCase() + payment.status.slice(1) %>
                </div>
                <div class="order-actions">
                  <button class="order-action-btn" title="View Details">
                    <i data-lucide="eye"></i>
                  </button>
                  <button class="order-action-btn" title="Download Receipt">
                    <i data-lucide="download"></i>
                  </button>
                </div>
              </div>
            <% }); %>
          </div>
        </div>
      </div>
    </main>
  </div>

<%- include('partials/footer') %>
