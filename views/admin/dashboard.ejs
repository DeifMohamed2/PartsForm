<%- include('partials/header') %>
<link rel="stylesheet" href="/css/adminCSS/admin-dashboard.css">
<style>
  /* Module-Specific Unique Designs */
  
  /* Automotive Module - Professional Blue Theme */
  .module-automotive .module-info-banner {
    background: linear-gradient(135deg, rgba(14, 165, 233, 0.08) 0%, rgba(59, 130, 246, 0.04) 50%, transparent 100%);
    border-color: rgba(14, 165, 233, 0.3);
  }
  .module-automotive .module-info-icon {
    background: linear-gradient(135deg, #0ea5e9 0%, #0369a1 100%);
  }
  .module-automotive .stat-card.module-themed {
    border-top: 3px solid #0ea5e9;
    background: linear-gradient(135deg, rgba(14, 165, 233, 0.03) 0%, var(--admin-bg-primary) 100%);
  }
  .module-automotive .chart-card {
    border-top: 3px solid #0ea5e9;
  }
  .module-automotive .hero-stat-grid .stat-icon {
    background: linear-gradient(135deg, rgba(14, 165, 233, 0.15), rgba(14, 165, 233, 0.08));
  }

  /* Aviation Module - Sky/Professional Theme */
  .module-aviation .module-info-banner {
    background: linear-gradient(135deg, rgba(14, 165, 233, 0.08) 0%, rgba(59, 130, 246, 0.04) 50%, transparent 100%);
    border-color: rgba(14, 165, 233, 0.3);
  }
  .module-aviation .module-info-icon {
    background: linear-gradient(135deg, #0ea5e9 0%, #0369a1 100%);
  }
  .module-aviation .stat-card.module-themed {
    border-top: 3px solid #0ea5e9;
    background: linear-gradient(135deg, rgba(14, 165, 233, 0.03) 0%, var(--admin-bg-primary) 100%);
  }
  .module-aviation .chart-card {
    border-top: 3px solid #0ea5e9;
  }

  /* Machinery Module - Industrial/Solid Theme */
  .module-machinery .module-info-banner {
    background: linear-gradient(135deg, rgba(234, 179, 8, 0.08) 0%, rgba(202, 138, 4, 0.04) 50%, transparent 100%);
    border-color: rgba(234, 179, 8, 0.3);
  }
  .module-machinery .module-info-icon {
    background: linear-gradient(135deg, #eab308 0%, #a16207 100%);
  }
  .module-machinery .stat-card.module-themed {
    border-top: 3px solid #eab308;
    background: linear-gradient(135deg, rgba(234, 179, 8, 0.03) 0%, var(--admin-bg-primary) 100%);
  }
  .module-machinery .chart-card {
    border-top: 3px solid #eab308;
  }
  .module-machinery .equipment-tracker {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  .module-machinery .equipment-card {
    background: var(--admin-bg-primary);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    padding: 1.25rem;
    text-align: center;
    transition: var(--admin-transition);
  }
  .module-machinery .equipment-card:hover {
    border-color: #eab308;
    box-shadow: var(--admin-shadow-md);
  }
  .module-machinery .equipment-icon {
    width: 50px;
    height: 50px;
    background: rgba(234, 179, 8, 0.12);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 0.75rem;
    color: #eab308;
  }
  .module-machinery .equipment-name { font-weight: 600; color: var(--admin-text-primary); }
  .module-machinery .equipment-count { font-size: 0.85rem; color: var(--admin-text-muted); }

  /* Hero Stats Grid - More prominent */
  .hero-stat-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
  }
  .hero-stat {
    background: var(--admin-bg-primary);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    padding: 1.25rem;
    text-align: center;
    transition: var(--admin-transition);
    box-shadow: var(--admin-shadow-sm);
  }
  .hero-stat:hover {
    border-color: var(--module-border);
    transform: translateY(-2px);
    box-shadow: var(--admin-shadow-md);
  }
  .hero-stat-icon {
    width: 45px;
    height: 45px;
    background: var(--module-bg-accent);
    border-radius: var(--admin-radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 0.75rem;
    color: var(--module-primary);
  }
  .hero-stat-icon i { width: 22px; height: 22px; }
  .hero-stat-value {
    font-size: 1.5rem;
    font-weight: 800;
    color: var(--admin-text-primary);
    line-height: 1.2;
  }
  .hero-stat-label {
    font-size: 0.75rem;
    color: var(--admin-text-muted);
    margin-top: 0.25rem;
  }
  .hero-stat-change {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    font-weight: 600;
    margin-top: 0.5rem;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
  }
  .hero-stat-change.positive { background: rgba(16, 185, 129, 0.12); color: #059669; }
  .hero-stat-change.negative { background: rgba(239, 68, 68, 0.12); color: #dc2626; }
  .hero-stat-change i { width: 12px; height: 12px; }

  /* Multi Chart Grid */
  .multi-chart-grid {
    display: grid;
    grid-template-columns: 1.5fr 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }
  .chart-card.full-width {
    grid-column: span 2;
  }
  
  /* Performance Metrics Row - Simplified */
  .performance-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
  }
  .performance-card {
    background: var(--admin-bg-primary);
    border: 1px solid var(--admin-border);
    border-radius: var(--admin-radius-lg);
    padding: 1.25rem;
    box-shadow: var(--admin-shadow-sm);
    transition: var(--admin-transition);
  }
  .performance-card:hover {
    border-color: var(--admin-border-medium);
    box-shadow: var(--admin-shadow-md);
  }
  .performance-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
  }
  .performance-icon {
    width: 36px;
    height: 36px;
    background: var(--admin-bg-tertiary);
    border-radius: var(--admin-radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--admin-text-muted);
  }
  .performance-icon i { width: 18px; height: 18px; }
  .performance-title {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--admin-text-muted);
  }
  .performance-value {
    font-size: 1.75rem;
    font-weight: 800;
    color: var(--admin-text-primary);
    margin-bottom: 0.5rem;
  }
  .performance-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.75rem;
    color: var(--admin-text-muted);
  }
  .performance-meta .positive { color: #10b981; }
  .performance-meta .negative { color: #ef4444; }

  /* Responsive */
  @media (max-width: 1400px) {
    .hero-stat-grid { grid-template-columns: repeat(3, 1fr); }
    .multi-chart-grid { grid-template-columns: 1fr 1fr; }
    .multi-chart-grid .chart-card.full-width { grid-column: span 1; }
    .performance-row { grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 768px) {
    .hero-stat-grid { grid-template-columns: repeat(2, 1fr); }
    .multi-chart-grid { grid-template-columns: 1fr; }
    .performance-row { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
  <div class="admin-wrapper">
    <%- include('partials/sidebar', { activePage: 'dashboard' }) %>
    
    <main class="admin-main">
      <%- include('partials/topbar', { pageTitle: 'Dashboard' }) %>
      
      <div class="admin-content">
        <!-- MAIN DASHBOARD - Premium Overview Design -->
        <div class="main-dashboard-hero" style="background: linear-gradient(135deg, #1e3a5f 0%, #2b5278 50%, #3d6a96 100%); border-radius: var(--admin-radius-xl); padding: 2rem; margin-bottom: 2rem; color: white; position: relative; overflow: hidden;">
          <div style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: rgba(255,255,255,0.05); border-radius: 50%;"></div>
          <div style="position: absolute; bottom: -30px; left: 30%; width: 150px; height: 150px; background: rgba(255,255,255,0.03); border-radius: 50%;"></div>
          <div style="display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 1;">
            <div>
              <h2 style="font-size: 1.75rem; font-weight: 800; margin-bottom: 0.5rem;">Welcome to PARTSFORM Admin</h2>
              <p style="opacity: 0.8; font-size: 0.95rem;">Automotive Parts Platform - Complete overview of platform performance</p>
            </div>
            <div style="display: flex; gap: 1rem;">
              <div style="text-align: center; padding: 1rem 1.5rem; background: rgba(255,255,255,0.1); border-radius: var(--admin-radius-lg); backdrop-filter: blur(10px);">
                <div style="font-size: 1.75rem; font-weight: 800;"><%= stats.totalOrders.toLocaleString() %></div>
                <div style="font-size: 0.75rem; opacity: 0.8;">Total Orders</div>
              </div>
              <div style="text-align: center; padding: 1rem 1.5rem; background: rgba(255,255,255,0.1); border-radius: var(--admin-radius-lg); backdrop-filter: blur(10px);">
                <% var displayRevenue = stats.totalRevenue > 0 ? stats.totalRevenue : stats.potentialRevenue; %>
                <div style="font-size: 1.75rem; font-weight: 800;"><%= displayRevenue >= 1000000 ? '$' + (displayRevenue / 1000000).toFixed(2) + 'M' : '$' + (displayRevenue / 1000).toFixed(1) + 'K' %></div>
                <div style="font-size: 0.75rem; opacity: 0.8;"><%= stats.totalRevenue > 0 ? 'Revenue' : 'Pipeline' %></div>
              </div>
              <div style="text-align: center; padding: 1rem 1.5rem; background: rgba(255,255,255,0.1); border-radius: var(--admin-radius-lg); backdrop-filter: blur(10px);">
                <div style="font-size: 1.75rem; font-weight: 800;"><%= stats.totalBuyers || 0 %></div>
                <div style="font-size: 0.75rem; opacity: 0.8;">Customers</div>
              </div>
              <div style="text-align: center; padding: 1rem 1.5rem; background: rgba(255,255,255,0.1); border-radius: var(--admin-radius-lg); backdrop-filter: blur(10px);">
                <div style="font-size: 1.75rem; font-weight: 800;"><%= stats.fulfillmentRate %>%</div>
                <div style="font-size: 0.75rem; opacity: 0.8;">Fulfillment</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Automotive Stats Overview - Single Focus -->
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; margin-bottom: 2rem;">
          <div style="background: linear-gradient(135deg, rgba(14, 165, 233, 0.08) 0%, white 100%); border: 2px solid rgba(14, 165, 233, 0.2); border-radius: var(--admin-radius-xl); padding: 1.5rem; text-align: center;">
            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #0ea5e9, #0369a1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; margin: 0 auto 1rem;">
              <i data-lucide="shopping-cart" style="width: 24px; height: 24px;"></i>
            </div>
            <div style="font-size: 1.75rem; font-weight: 800; color: #0ea5e9;"><%= stats.totalOrders.toLocaleString() %></div>
            <div style="font-size: 0.85rem; color: #64748b;">Total Orders</div>
          </div>
          <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, white 100%); border: 2px solid rgba(16, 185, 129, 0.2); border-radius: var(--admin-radius-xl); padding: 1.5rem; text-align: center;">
            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; margin: 0 auto 1rem;">
              <i data-lucide="dollar-sign" style="width: 24px; height: 24px;"></i>
            </div>
            <% if (stats.totalRevenue > 0) { %>
              <div style="font-size: 1.75rem; font-weight: 800; color: #10b981;"><%= stats.totalRevenue >= 1000000 ? '$' + (stats.totalRevenue / 1000000).toFixed(2) + 'M' : '$' + (stats.totalRevenue / 1000).toFixed(1) + 'K' %></div>
              <div style="font-size: 0.85rem; color: #64748b;">Realized Revenue</div>
            <% } else { %>
              <div style="font-size: 1.75rem; font-weight: 800; color: #f59e0b;"><%= stats.potentialRevenue >= 1000000 ? '$' + (stats.potentialRevenue / 1000000).toFixed(2) + 'M' : '$' + (stats.potentialRevenue / 1000).toFixed(1) + 'K' %></div>
              <div style="font-size: 0.85rem; color: #64748b;">Pipeline Value</div>
              <div style="font-size: 0.65rem; color: #f59e0b; margin-top: 0.25rem;">Pending Orders</div>
            <% } %>
          </div>
          <div style="background: linear-gradient(135deg, rgba(14, 165, 233, 0.08) 0%, white 100%); border: 2px solid rgba(14, 165, 233, 0.2); border-radius: var(--admin-radius-xl); padding: 1.5rem; text-align: center;">
            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #0ea5e9, #0369a1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; margin: 0 auto 1rem;">
              <i data-lucide="users" style="width: 24px; height: 24px;"></i>
            </div>
            <div style="font-size: 1.75rem; font-weight: 800; color: #0ea5e9;"><%= stats.totalBuyers || 0 %></div>
            <div style="font-size: 0.85rem; color: #64748b;">Customers</div>
          </div>
          <div style="background: linear-gradient(135deg, <%= stats.fulfillmentRate >= 50 ? 'rgba(16, 185, 129, 0.08)' : 'rgba(245, 158, 11, 0.08)' %> 0%, white 100%); border: 2px solid <%= stats.fulfillmentRate >= 50 ? 'rgba(16, 185, 129, 0.2)' : 'rgba(245, 158, 11, 0.2)' %>; border-radius: var(--admin-radius-xl); padding: 1.5rem; text-align: center;">
            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, <%= stats.fulfillmentRate >= 50 ? '#10b981, #059669' : '#f59e0b, #d97706' %>); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; margin: 0 auto 1rem;">
              <i data-lucide="<%= stats.fulfillmentRate >= 50 ? 'check-circle' : 'clock' %>" style="width: 24px; height: 24px;"></i>
            </div>
            <div style="font-size: 1.75rem; font-weight: 800; color: <%= stats.fulfillmentRate >= 50 ? '#10b981' : '#f59e0b' %>;"><%= stats.fulfillmentRate %>%</div>
            <div style="font-size: 0.85rem; color: #64748b;">Fulfillment Rate</div>
            <% if (stats.fulfillmentRate === 0 && stats.ordersPending > 0) { %>
              <div style="font-size: 0.65rem; color: #f59e0b; margin-top: 0.25rem;"><%= stats.ordersPending %> orders pending</div>
            <% } %>
          </div>
        </div>

        <!-- MAIN DASHBOARD - Unique Charts & Analytics Layout -->
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
          <!-- Left: Main Analytics -->
          <div>
            <!-- Revenue Trend - Full Width -->
            <div class="chart-card" style="margin-bottom: 1.5rem;">
              <div class="chart-header">
                <div>
                  <div class="chart-title">Platform Revenue Overview</div>
                  <div class="chart-subtitle">All industries combined - 2025</div>
                </div>
                <div style="display: flex; gap: 0.5rem;">
                  <button class="admin-btn admin-btn-secondary" style="padding: 0.4rem 0.75rem; font-size: 0.8rem;">Week</button>
                  <button class="admin-btn admin-btn-primary" style="padding: 0.4rem 0.75rem; font-size: 0.8rem;">Month</button>
                  <button class="admin-btn admin-btn-secondary" style="padding: 0.4rem 0.75rem; font-size: 0.8rem;">Year</button>
                </div>
              </div>
              <div class="chart-container" style="height: 280px;">
                <canvas id="revenueChart"></canvas>
              </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div class="chart-card">
                <div class="chart-header">
                  <div>
                    <div class="chart-title" style="display: flex; align-items: center; gap: 0.5rem;">
                      <i data-lucide="pie-chart" style="width: 16px; height: 16px; color: #8b5cf6;"></i>
                      Order Distribution
                    </div>
                    <div class="chart-subtitle">By status breakdown</div>
                  </div>
                </div>
                <div class="chart-container" style="height: 200px;">
                  <canvas id="ordersChart"></canvas>
                </div>
                <div style="display: flex; justify-content: center; gap: 0.75rem; padding-top: 0.5rem; flex-wrap: wrap;">
                  <div style="display: flex; align-items: center; gap: 0.4rem; font-size: 0.7rem;">
                    <span style="width: 8px; height: 8px; background: #f59e0b; border-radius: 50%;"></span>
                    Pending (<%= stats.ordersPending || 0 %>)
                  </div>
                  <div style="display: flex; align-items: center; gap: 0.4rem; font-size: 0.7rem;">
                    <span style="width: 8px; height: 8px; background: #3b82f6; border-radius: 50%;"></span>
                    Processing (<%= stats.ordersProcessing || 0 %>)
                  </div>
                  <div style="display: flex; align-items: center; gap: 0.4rem; font-size: 0.7rem;">
                    <span style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%;"></span>
                    Shipped (<%= stats.ordersShipped || 0 %>)
                  </div>
                  <div style="display: flex; align-items: center; gap: 0.4rem; font-size: 0.7rem;">
                    <span style="width: 8px; height: 8px; background: #10b981; border-radius: 50%;"></span>
                    Completed (<%= (stats.ordersDelivered || 0) + (stats.ordersCompleted || 0) %>)
                  </div>
                </div>
              </div>
              <div class="chart-card">
                <div class="chart-header">
                  <div>
                    <div class="chart-title" style="display: flex; align-items: center; gap: 0.5rem;">
                      <i data-lucide="map-pin" style="width: 16px; height: 16px; color: #0ea5e9;"></i>
                      Top Countries
                    </div>
                    <div class="chart-subtitle">By order volume</div>
                  </div>
                </div>
                <div class="chart-container" style="height: 220px;">
                  <canvas id="countriesChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Right: Live Activity & Stats Sidebar -->
          <div>
            <!-- Performance Summary Card -->
            <div style="background: linear-gradient(135deg, #1e3a5f, #2b5278); border-radius: var(--admin-radius-xl); padding: 1.5rem; margin-bottom: 1rem; color: white;">
              <h4 style="font-size: 0.95rem; font-weight: 600; margin-bottom: 1rem; opacity: 0.9;">üìä Platform Health</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div style="text-align: center;">
                  <div style="font-size: 1.5rem; font-weight: 800;"><%= stats.fulfillmentRate %>%</div>
                  <div style="font-size: 0.7rem; opacity: 0.7;">Fulfillment</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.5rem; font-weight: 800;"><%= stats.totalBuyers || 0 %></div>
                  <div style="font-size: 0.7rem; opacity: 0.7;">Customers</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.5rem; font-weight: 800;"><%= stats.pendingTickets %></div>
                  <div style="font-size: 0.7rem; opacity: 0.7;">Open Tickets</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.5rem; font-weight: 800;"><%= stats.totalProducts.toLocaleString() %></div>
                  <div style="font-size: 0.7rem; opacity: 0.7;">Parts</div>
                </div>
              </div>
            </div>
            
            <!-- Weekly Overview -->
            <div class="chart-card" style="margin-bottom: 1rem;">
              <div class="chart-header">
                <div>
                  <div class="chart-title">This Week</div>
                  <div class="chart-subtitle">Daily order volume</div>
                </div>
              </div>
              <div class="chart-container" style="height: 140px;">
                <canvas id="weeklyChart"></canvas>
              </div>
            </div>
            
            <!-- Order Status Mini -->
            <div class="chart-card">
              <div class="chart-header">
                <div>
                  <div class="chart-title">Order Pipeline</div>
                  <div class="chart-subtitle">Current status</div>
                </div>
              </div>
              <div class="chart-container" style="height: 140px;">
                <canvas id="statusChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Main Dashboard: Recent Activity Row (2 columns) -->
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
          <!-- Recent Orders - Takes more space -->
          <div class="orders-card" style="margin-bottom: 0;">
            <div class="orders-header">
              <h3 class="orders-title">Recent Orders</h3>
              <a href="/admin/orders" class="admin-btn admin-btn-secondary">
                <i data-lucide="external-link"></i>
                View All
              </a>
            </div>
            <div class="orders-body" style="max-height: 320px; overflow-y: auto;">
              <!-- Table Header -->
              <div style="display: flex; align-items: center; padding: 0.75rem 1rem; border-bottom: 2px solid var(--admin-border); background: var(--admin-bg-secondary); gap: 1rem; position: sticky; top: 0;">
                <div style="min-width: 110px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px;">Order ID</div>
                <div style="flex: 1; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px;">Customer</div>
                <div style="min-width: 90px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px; text-align: right;">Amount</div>
                <div style="min-width: 36px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px; text-align: center;">Type</div>
                <div style="min-width: 100px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px;">Status</div>
              </div>
              <% recentOrders.slice(0, 8).forEach(function(order) { %>
                <div class="order-row" style="display: flex; align-items: center; padding: 0.875rem 1rem; border-bottom: 1px solid var(--admin-border); gap: 1rem;">
                  <div style="min-width: 110px; font-weight: 600; color: var(--admin-primary); font-size: 0.85rem;"><%= order.id %></div>
                  <div style="flex: 1; font-weight: 500; color: var(--admin-text-primary);"><%= order.customer %></div>
                  <div style="min-width: 90px; font-weight: 700; color: var(--admin-text-primary); text-align: right;">$<%= order.amount.toLocaleString() %></div>
                  <div style="min-width: 36px; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: <%= order.industry === 'automotive' ? 'rgba(220, 38, 38, 0.12)' : order.industry === 'aviation' ? 'rgba(14, 165, 233, 0.12)' : 'rgba(234, 179, 8, 0.12)' %>; color: <%= order.industry === 'automotive' ? '#dc2626' : order.industry === 'aviation' ? '#0ea5e9' : '#eab308' %>;">
                    <% if (order.industry === 'automotive') { %>
                      <i data-lucide="car" style="width: 16px; height: 16px;"></i>
                    <% } else if (order.industry === 'aviation') { %>
                      <i data-lucide="plane" style="width: 16px; height: 16px;"></i>
                    <% } else { %>
                      <i data-lucide="construction" style="width: 16px; height: 16px;"></i>
                    <% } %>
                  </div>
                  <div style="min-width: 100px; display: flex; align-items: center; gap: 0.4rem; padding: 0.35rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; background: <%= order.status === 'pending' ? 'rgba(245, 158, 11, 0.12)' : order.status === 'processing' ? 'rgba(59, 130, 246, 0.12)' : order.status === 'shipped' ? 'rgba(139, 92, 246, 0.12)' : 'rgba(16, 185, 129, 0.12)' %>; color: <%= order.status === 'pending' ? '#d97706' : order.status === 'processing' ? '#2563eb' : order.status === 'shipped' ? '#7c3aed' : '#059669' %>;">
                    <% if (order.status === 'pending') { %>
                      <i data-lucide="clock" style="width: 12px; height: 12px;"></i>
                    <% } else if (order.status === 'processing') { %>
                      <i data-lucide="loader" style="width: 12px; height: 12px;"></i>
                    <% } else if (order.status === 'shipped') { %>
                      <i data-lucide="truck" style="width: 12px; height: 12px;"></i>
                    <% } else { %>
                      <i data-lucide="check-circle" style="width: 12px; height: 12px;"></i>
                    <% } %>
                    <%= order.status.charAt(0).toUpperCase() + order.status.slice(1) %>
                  </div>
                </div>
              <% }); %>
            </div>
          </div>
          
          <!-- Open Tickets -->
          <div class="activity-card" style="margin-bottom: 0;">
            <div class="activity-header">
              <h3 class="activity-title">Open Tickets</h3>
              <a href="/admin/tickets" class="admin-btn admin-btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">
                View All
              </a>
            </div>
            <div class="activity-list" style="max-height: 280px; overflow-y: auto;">
              <% var openTickets = tickets.filter(function(t) { return t.status === 'open' || t.status === 'in-progress'; }); %>
              <% openTickets.slice(0, 6).forEach(function(ticket) { %>
                <div class="activity-item">
                  <div class="activity-icon <%= ticket.status === 'open' ? 'warning' : '' %>">
                    <i data-lucide="<%= ticket.priority === 'urgent' ? 'alert-circle' : 'message-square' %>"></i>
                  </div>
                  <div class="activity-content" style="flex: 1;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div class="activity-text"><strong><%= ticket.id %></strong></div>
                      <span style="font-size: 0.65rem; padding: 0.15rem 0.4rem; border-radius: 8px; background: <%= ticket.priority === 'urgent' ? 'rgba(239, 68, 68, 0.15)' : ticket.priority === 'high' ? 'rgba(245, 158, 11, 0.15)' : 'rgba(59, 130, 246, 0.15)' %>; color: <%= ticket.priority === 'urgent' ? '#dc2626' : ticket.priority === 'high' ? '#d97706' : '#3b82f6' %>;"><%= ticket.priority %></span>
                    </div>
                    <div class="activity-time" style="font-size: 0.75rem;"><%= ticket.subject.substring(0, 30) %><%= ticket.subject.length > 30 ? '...' : '' %></div>
                  </div>
                </div>
              <% }); %>
            </div>
          </div>
        </div>

        <!-- ============================================
             AUTOMOTIVE ANALYTICS SECTION
             ============================================ -->
        
        <!-- Top Buyers & Most Wanted Parts Row -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
          
          <!-- Top Buyers with Best Profit -->
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title" style="display: flex; align-items: center; gap: 0.5rem;">
                  <i data-lucide="trophy" style="width: 18px; height: 18px; color: #f59e0b;"></i>
                  Top Buyers by Revenue
                </div>
                <% var hasCompletedBuyers = typeof topBuyers !== 'undefined' && topBuyers.length > 0 && !topBuyers[0].isPending; %>
                <div class="chart-subtitle"><%= hasCompletedBuyers ? 'From completed orders' : 'From all orders (pending)' %></div>
              </div>
              <a href="/admin/users" class="admin-btn admin-btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">View All</a>
            </div>
            <div style="padding: 0 1rem 1rem;">
              <% if (typeof topBuyers !== 'undefined' && topBuyers.length > 0) { %>
                <% topBuyers.forEach(function(buyer, index) { %>
                  <% 
                    let rankStyle = '';
                    let rankBg = '';
                    if (index === 0) {
                      rankStyle = 'background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(234, 179, 8, 0.05)); border-radius: 12px;';
                      rankBg = 'background: linear-gradient(135deg, #f59e0b, #d97706);';
                    } else if (index === 1) {
                      rankStyle = 'background: rgba(148, 163, 184, 0.08); border-radius: 12px;';
                      rankBg = 'background: linear-gradient(135deg, #94a3b8, #64748b);';
                    } else if (index === 2) {
                      rankStyle = 'background: rgba(194, 120, 3, 0.08); border-radius: 12px;';
                      rankBg = 'background: linear-gradient(135deg, #cd7f32, #b8860b);';
                    } else {
                      rankStyle = 'border: 1px solid #e2e8f0; border-radius: 12px;';
                      rankBg = 'background: #f1f5f9;';
                    }
                  %>
                  <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; margin-bottom: 0.5rem; <%= rankStyle %>">
                    <!-- Rank Badge -->
                    <div style="width: <%= index < 3 ? '28px' : '24px' %>; height: <%= index < 3 ? '28px' : '24px' %>; <%= rankBg %> border-radius: 50%; display: flex; align-items: center; justify-content: center; color: <%= index < 3 ? 'white' : '#64748b' %>; font-weight: 800; font-size: <%= index < 3 ? '0.75rem' : '0.7rem' %>; flex-shrink: 0;">#<%= index + 1 %></div>
                    
                    <!-- Buyer Avatar -->
                    <div style="width: 44px; height: 44px; border-radius: 50%; overflow: hidden; border: 2px solid <%= index === 0 ? '#f59e0b' : index === 1 ? '#94a3b8' : index === 2 ? '#cd7f32' : '#e2e8f0' %>; flex-shrink: 0;">
                      <% if (buyer.avatar) { %>
                        <img src="<%= buyer.avatar %>" alt="<%= buyer.fullName %>" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div style="display: none; width: 100%; height: 100%; background: linear-gradient(135deg, #3b82f6, #1d4ed8); align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1rem;">
                          <%= buyer.firstName ? buyer.firstName.charAt(0).toUpperCase() : 'U' %><%= buyer.lastName ? buyer.lastName.charAt(0).toUpperCase() : '' %>
                        </div>
                      <% } else { %>
                        <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #3b82f6, #1d4ed8); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1rem;">
                          <%= buyer.firstName ? buyer.firstName.charAt(0).toUpperCase() : 'U' %><%= buyer.lastName ? buyer.lastName.charAt(0).toUpperCase() : '' %>
                        </div>
                      <% } %>
                    </div>
                    
                    <!-- Buyer Info -->
                    <div style="flex: 1; min-width: 0;">
                      <div style="font-weight: 700; color: #1e293b; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><%= buyer.fullName %></div>
                      <div style="font-size: 0.75rem; color: #0ea5e9; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; gap: 4px;">
                        <i data-lucide="building-2" style="width: 11px; height: 11px; flex-shrink: 0;"></i>
                        <%= buyer.companyName %>
                      </div>
                      <div style="font-size: 0.7rem; color: #64748b; margin-top: 2px; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="background: <%= buyer.isPending ? 'rgba(245, 158, 11, 0.1)' : 'rgba(16, 185, 129, 0.1)' %>; color: <%= buyer.isPending ? '#d97706' : '#059669' %>; padding: 0.1rem 0.35rem; border-radius: 8px; font-weight: 600;"><%= buyer.orderCount %> orders</span>
                        <% if (buyer.country && buyer.country !== 'N/A') { %>
                          <span>üìç <%= buyer.country %></span>
                        <% } %>
                      </div>
                    </div>
                    
                    <!-- Revenue -->
                    <div style="text-align: right; flex-shrink: 0;">
                      <div style="font-weight: 800; color: <%= buyer.isPending ? '#f59e0b' : '#10b981' %>; font-size: 1rem;">$<%= buyer.totalSpent.toLocaleString() %></div>
                      <div style="font-size: 0.65rem; color: #64748b;"><%= buyer.isPending ? 'Pending' : buyer.fulfillmentRate + '% fulfilled' %></div>
                    </div>
                  </div>
                <% }); %>
              <% } else { %>
                <div style="padding: 2rem; text-align: center; color: #64748b;">
                  <i data-lucide="users" style="width: 48px; height: 48px; opacity: 0.3; margin-bottom: 1rem;"></i>
                  <div>No buyer data available yet</div>
                </div>
              <% } %>
            </div>
          </div>
          
          <!-- Most Wanted Parts -->
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title" style="display: flex; align-items: center; gap: 0.5rem;">
                  <i data-lucide="flame" style="width: 18px; height: 18px; color: #ef4444;"></i>
                  Most Wanted Parts
                </div>
                <div class="chart-subtitle">Top ordered parts by sales</div>
              </div>
              <a href="/admin/parts-analytics" class="admin-btn admin-btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">View All</a>
            </div>
            <div style="padding: 0 1rem 1rem;">
              <% 
                const partIcons = ['disc', 'filter', 'zap', 'settings', 'cog'];
                const partColors = ['#0ea5e9', '#10b981', '#8b5cf6', '#f59e0b', '#ec4899'];
                const partBgColors = [
                  'rgba(14, 165, 233, 0.12)',
                  'rgba(16, 185, 129, 0.12)',
                  'rgba(139, 92, 246, 0.12)',
                  'rgba(245, 158, 11, 0.12)',
                  'rgba(236, 72, 153, 0.12)'
                ];
              %>
              <% if (typeof mostWantedParts !== 'undefined' && mostWantedParts.length > 0) { %>
                <% mostWantedParts.forEach(function(part, index) { %>
                  <div style="display: flex; align-items: center; gap: 1rem; padding: 0.875rem 1rem; border-radius: 14px; margin-bottom: 0.625rem; border: 1px solid #e2e8f0; background: white; transition: all 0.2s ease;" onmouseover="this.style.borderColor='<%= partColors[index % 5] %>'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.08)';" onmouseout="this.style.borderColor='#e2e8f0'; this.style.boxShadow='none';">
                    <div style="display: flex; align-items: center; justify-content: center; width: 28px; height: 28px; background: <%= partBgColors[index % 5] %>; border-radius: 8px; font-size: 0.75rem; font-weight: 700; color: <%= partColors[index % 5] %>;">
                      #<%= index + 1 %>
                    </div>
                    <div style="width: 42px; height: 42px; background: linear-gradient(135deg, <%= partBgColors[index % 5] %>, rgba(255,255,255,0.5)); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                      <i data-lucide="<%= partIcons[index % 5] %>" style="width: 20px; height: 20px; color: <%= partColors[index % 5] %>;"></i>
                    </div>
                    <div style="flex: 1; min-width: 0;">
                      <div style="font-weight: 600; color: #1e293b; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" title="<%= part.description %>"><%= part.description || part.partNumber %></div>
                      <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.25rem;">
                        <span style="font-size: 0.7rem; color: #64748b; font-family: monospace; background: #f1f5f9; padding: 0.15rem 0.4rem; border-radius: 4px;"><%= part.partNumber %></span>
                        <% if (part.brand && part.brand !== 'N/A') { %>
                          <span style="font-size: 0.65rem; color: #94a3b8;">‚Ä¢</span>
                          <span style="font-size: 0.7rem; color: #64748b;"><%= part.brand %></span>
                        <% } %>
                      </div>
                    </div>
                    <div style="text-align: right; flex-shrink: 0;">
                      <div style="font-weight: 700; font-size: 0.95rem; color: <%= partColors[index % 5] %>;"><%= part.orderCount %> <span style="font-weight: 400; font-size: 0.75rem; color: #64748b;">orders</span></div>
                      <div style="font-size: 0.75rem; color: #10b981; font-weight: 600; margin-top: 0.125rem;">$<%= (part.totalRevenue || 0).toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) %></div>
                    </div>
                  </div>
                <% }); %>
              <% } else { %>
                <div style="padding: 2.5rem; text-align: center; color: #64748b; background: #f8fafc; border-radius: 12px; border: 1px dashed #e2e8f0;">
                  <i data-lucide="package" style="width: 48px; height: 48px; opacity: 0.3; margin-bottom: 0.75rem;"></i>
                  <div style="font-size: 0.9rem; font-weight: 500;">No parts data available yet</div>
                  <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 0.25rem;">Parts will appear here once orders are placed</div>
                </div>
              <% } %>
            </div>
          </div>
        </div>
        
        <!-- Order Status Distribution & Inventory -->
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title">Order Status Distribution</div>
                <div class="chart-subtitle">Current orders by status</div>
              </div>
            </div>
            <div style="padding: 1rem;">
              <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem;">
                <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05)); border-radius: 12px; border: 1px solid rgba(245, 158, 11, 0.2);">
                  <i data-lucide="clock" style="width: 28px; height: 28px; color: #f59e0b; margin-bottom: 0.5rem;"></i>
                  <div style="font-size: 1.5rem; font-weight: 800; color: #f59e0b;"><%= stats.ordersPending || 0 %></div>
                  <div style="font-size: 0.8rem; color: #64748b;">Pending</div>
                </div>
                <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05)); border-radius: 12px; border: 1px solid rgba(59, 130, 246, 0.2);">
                  <i data-lucide="loader" style="width: 28px; height: 28px; color: #3b82f6; margin-bottom: 0.5rem;"></i>
                  <div style="font-size: 1.5rem; font-weight: 800; color: #3b82f6;"><%= stats.ordersProcessing || 0 %></div>
                  <div style="font-size: 0.8rem; color: #64748b;">Processing</div>
                </div>
                <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05)); border-radius: 12px; border: 1px solid rgba(139, 92, 246, 0.2);">
                  <i data-lucide="truck" style="width: 28px; height: 28px; color: #8b5cf6; margin-bottom: 0.5rem;"></i>
                  <div style="font-size: 1.5rem; font-weight: 800; color: #8b5cf6;"><%= stats.ordersShipped || 0 %></div>
                  <div style="font-size: 0.8rem; color: #64748b;">Shipped</div>
                </div>
                <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05)); border-radius: 12px; border: 1px solid rgba(16, 185, 129, 0.2);">
                  <i data-lucide="check-circle" style="width: 28px; height: 28px; color: #10b981; margin-bottom: 0.5rem;"></i>
                  <div style="font-size: 1.5rem; font-weight: 800; color: #10b981;"><%= (stats.ordersDelivered || 0) + (stats.ordersCompleted || 0) %></div>
                  <div style="font-size: 0.8rem; color: #64748b;">Completed</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Global Reach - Orders by Country -->
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title" style="display: flex; align-items: center; gap: 0.5rem;">
                  <i data-lucide="globe" style="width: 18px; height: 18px; color: #0ea5e9;"></i>
                  Global Reach
                </div>
                <div class="chart-subtitle">Orders by customer countries</div>
              </div>
            </div>
            <div style="padding: 0.75rem 1rem 1rem;">
              <% 
                // Country flags by both code and full name
                const countryFlags = {
                  'US': 'üá∫üá∏', 'United States': 'üá∫üá∏', 'GB': 'üá¨üáß', 'United Kingdom': 'üá¨üáß', 
                  'DE': 'üá©üá™', 'Germany': 'üá©üá™', 'FR': 'üá´üá∑', 'France': 'üá´üá∑', 
                  'CA': 'üá®üá¶', 'Canada': 'üá®üá¶', 'AU': 'üá¶üá∫', 'Australia': 'üá¶üá∫',
                  'JP': 'üáØüáµ', 'Japan': 'üáØüáµ', 'CN': 'üá®üá≥', 'China': 'üá®üá≥', 
                  'IN': 'üáÆüá≥', 'India': 'üáÆüá≥', 'BR': 'üáßüá∑', 'Brazil': 'üáßüá∑', 
                  'MX': 'üá≤üáΩ', 'Mexico': 'üá≤üáΩ', 'RU': 'üá∑üá∫', 'Russia': 'üá∑üá∫',
                  'AE': 'üá¶üá™', 'United Arab Emirates': 'üá¶üá™', 'UAE': 'üá¶üá™',
                  'SA': 'üá∏üá¶', 'Saudi Arabia': 'üá∏üá¶', 'KR': 'üá∞üá∑', 'South Korea': 'üá∞üá∑', 
                  'IT': 'üáÆüáπ', 'Italy': 'üáÆüáπ', 'ES': 'üá™üá∏', 'Spain': 'üá™üá∏', 'NL': 'üá≥üá±', 'Netherlands': 'üá≥üá±',
                  'SE': 'üá∏üá™', 'Sweden': 'üá∏üá™', 'CH': 'üá®üá≠', 'Switzerland': 'üá®üá≠', 
                  'PL': 'üáµüá±', 'Poland': 'üáµüá±', 'TR': 'üáπüá∑', 'Turkey': 'üáπüá∑',
                  'EG': 'üá™üá¨', 'Egypt': 'üá™üá¨', 'ZA': 'üáøüá¶', 'South Africa': 'üáøüá¶',
                  'NG': 'üá≥üá¨', 'Nigeria': 'üá≥üá¨', 'UA': 'üá∫üá¶', 'Ukraine': 'üá∫üá¶', 
                  'PK': 'üáµüá∞', 'Pakistan': 'üáµüá∞', 'ID': 'üáÆüá©', 'Indonesia': 'üáÆüá©', 
                  'TH': 'üáπüá≠', 'Thailand': 'üáπüá≠', 'MY': 'üá≤üáæ', 'Malaysia': 'üá≤üáæ',
                  'SG': 'üá∏üá¨', 'Singapore': 'üá∏üá¨', 'PH': 'üáµüá≠', 'Philippines': 'üáµüá≠', 
                  'VN': 'üáªüá≥', 'Vietnam': 'üáªüá≥', 'KW': 'üá∞üáº', 'Kuwait': 'üá∞üáº',
                  'QA': 'üá∂üá¶', 'Qatar': 'üá∂üá¶', 'BH': 'üáßüá≠', 'Bahrain': 'üáßüá≠',
                  'OM': 'üá¥üá≤', 'Oman': 'üá¥üá≤', 'JO': 'üáØüá¥', 'Jordan': 'üáØüá¥',
                  'LB': 'üá±üáß', 'Lebanon': 'üá±üáß', 'IQ': 'üáÆüá∂', 'Iraq': 'üáÆüá∂'
                };
                
                // Filter valid countries - accept both 2-letter codes and full names
                const rawCountries = typeof ordersByCountry !== 'undefined' ? ordersByCountry : [];
                const countries = rawCountries.filter(c => c.code && c.code !== 'XX' && c.code !== 'NA' && c.code !== 'N/A' && c.code.trim().length > 0);
                const maxOrders = countries.length > 0 ? Math.max(...countries.map(c => c.orderCount)) : 1;
                const barColors = ['#0ea5e9', '#10b981', '#8b5cf6', '#f59e0b', '#ec4899', '#06b6d4', '#84cc16', '#f97316'];
              %>
              <% if (countries.length > 0) { %>
                <% countries.slice(0, 5).forEach(function(country, index) { %>
                  <div style="margin-bottom: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.35rem;">
                      <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span style="font-size: 1.1rem;"><%= countryFlags[country.code] || 'üåç' %></span>
                        <span style="font-size: 0.8rem; font-weight: 600; color: #1e293b;"><%= country.name %></span>
                      </div>
                      <div style="display: flex; align-items: center; gap: 0.75rem;">
                        <span style="font-size: 0.75rem; color: #64748b;"><%= country.orderCount %> orders</span>
                        <span style="font-size: 0.75rem; font-weight: 700; color: #10b981;">$<%= (country.revenue || 0).toLocaleString() %></span>
                      </div>
                    </div>
                    <div style="height: 6px; background: #e2e8f0; border-radius: 10px; overflow: hidden;">
                      <div style="height: 100%; width: <%= Math.round((country.orderCount / maxOrders) * 100) %>%; background: linear-gradient(90deg, <%= barColors[index % barColors.length] %>, <%= barColors[(index + 1) % barColors.length] %>); border-radius: 10px; transition: width 0.5s ease;"></div>
                    </div>
                  </div>
                <% }); %>
              <% } else { %>
                <div style="padding: 1.5rem; text-align: center; color: #64748b;">
                  <i data-lucide="globe" style="width: 40px; height: 40px; opacity: 0.3; margin-bottom: 0.75rem;"></i>
                  <div style="font-size: 0.85rem;">No country data available</div>
                  <div style="font-size: 0.7rem; color: #94a3b8; margin-top: 0.25rem;">Country info will appear when customers set their location</div>
                </div>
              <% } %>
            </div>
          </div>
        </div>
        
        <!-- ============================================
             AI-POWERED INSIGHTS - PROFESSIONAL ANALYTICS HUB
             ============================================ -->
        <div class="ai-insights-section" style="margin-top: 2.5rem;">
          
          <!-- AI Insights Header Banner -->
          <div style="background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 40%, #2b5278 70%, #1e293b 100%); border-radius: 24px; padding: 0; position: relative; overflow: hidden; border: 1px solid rgba(59, 130, 246, 0.2);">
            
            <!-- Animated Background Elements -->
            <div style="position: absolute; top: -100px; right: -100px; width: 400px; height: 400px; background: radial-gradient(circle, rgba(59, 130, 246, 0.15) 0%, transparent 70%); border-radius: 50%; animation: pulse 8s ease-in-out infinite;"></div>
            <div style="position: absolute; bottom: -80px; left: -80px; width: 300px; height: 300px; background: radial-gradient(circle, rgba(139, 92, 246, 0.1) 0%, transparent 70%); border-radius: 50%; animation: pulse 10s ease-in-out infinite reverse;"></div>
            <div style="position: absolute; top: 50%; left: 50%; width: 600px; height: 600px; background: radial-gradient(circle, rgba(14, 165, 233, 0.05) 0%, transparent 60%); border-radius: 50%; transform: translate(-50%, -50%);"></div>
            
            <!-- Grid Pattern Overlay -->
            <div style="position: absolute; inset: 0; background-image: linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px); background-size: 40px 40px; pointer-events: none;"></div>
            
            <!-- Main Header Content -->
            <div style="position: relative; z-index: 1; padding: 2rem 2.5rem;">
              <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1.5rem;">
                
                <!-- Left: Title & Description -->
                <div style="display: flex; align-items: center; gap: 1.25rem;">
                  <div style="width: 64px; height: 64px; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%); border-radius: 18px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 32px rgba(59, 130, 246, 0.4), 0 0 0 1px rgba(255,255,255,0.1); animation: iconGlow 3s ease-in-out infinite;">
                    <i data-lucide="brain" style="width: 32px; height: 32px; color: white;"></i>
                  </div>
                  <div>
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.25rem;">
                      <h2 style="font-size: 1.75rem; font-weight: 800; color: white; margin: 0; letter-spacing: -0.02em;">AI Intelligence Hub</h2>
                      <span style="padding: 0.25rem 0.75rem; background: linear-gradient(135deg, #10b981, #059669); border-radius: 20px; font-size: 0.65rem; font-weight: 700; color: white; text-transform: uppercase; letter-spacing: 0.05em;">LIVE</span>
                    </div>
                    <p style="font-size: 1rem; color: rgba(255,255,255,0.7); margin: 0;">Predictive analytics & intelligent recommendations powered by machine learning</p>
                  </div>
                </div>
                
                <!-- Right: AI Status & Controls -->
                <div style="display: flex; align-items: center; gap: 1rem;">
                  <div style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px;">
                    <div style="width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: blink 2s ease-in-out infinite;"></div>
                    <span style="font-size: 0.8rem; color: #10b981; font-weight: 600;">Model Active</span>
                  </div>
                  <div style="padding: 0.5rem 1rem; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px;">
                    <span style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Last Analysis:</span>
                    <span style="font-size: 0.8rem; color: white; font-weight: 600; margin-left: 0.25rem;">2 min ago</span>
                  </div>
                  <button style="padding: 0.625rem 1.25rem; background: linear-gradient(135deg, #3b82f6, #2563eb); border: none; border-radius: 10px; color: white; font-size: 0.85rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; transition: all 0.3s; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                    <i data-lucide="refresh-cw" style="width: 16px; height: 16px;"></i>
                    Refresh Analysis
                  </button>
                </div>
              </div>
              
              <!-- AI Performance Metrics Bar -->
              <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 1rem; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
                <div style="text-align: center;">
                  <div style="font-size: 1.75rem; font-weight: 800; color: #10b981;">94.7%</div>
                  <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem;">Prediction Accuracy</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.75rem; font-weight: 800; color: #3b82f6;">2.4M</div>
                  <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem;">Data Points Analyzed</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.75rem; font-weight: 800; color: #8b5cf6;">156</div>
                  <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem;">Insights Generated</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.75rem; font-weight: 800; color: #f59e0b;">$847K</div>
                  <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem;">Revenue Impact</div>
                </div>
                <div style="text-align: center;">
                  <div style="font-size: 1.75rem; font-weight: 800; color: #06b6d4;">12</div>
                  <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem;">Action Items</div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- AI Insights Navigation Tabs -->
          <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 1.5rem; padding: 0.5rem; background: white; border-radius: 16px; border: 1px solid #e2e8f0; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
            <button class="ai-tab active" onclick="switchAITab('predictions')" style="flex: 1; padding: 0.875rem 1.5rem; background: linear-gradient(135deg, #2b5278, #1e3a54); border: none; border-radius: 12px; color: white; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s;">
              <i data-lucide="trending-up" style="width: 18px; height: 18px;"></i>
              Revenue Predictions
            </button>
            <button class="ai-tab" onclick="switchAITab('recommendations')" style="flex: 1; padding: 0.875rem 1.5rem; background: transparent; border: none; border-radius: 12px; color: #64748b; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s;">
              <i data-lucide="lightbulb" style="width: 18px; height: 18px;"></i>
              Smart Recommendations
            </button>
            <button class="ai-tab" onclick="switchAITab('anomalies')" style="flex: 1; padding: 0.875rem 1.5rem; background: transparent; border: none; border-radius: 12px; color: #64748b; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s;">
              <i data-lucide="alert-triangle" style="width: 18px; height: 18px;"></i>
              Anomaly Detection
            </button>
            <button class="ai-tab" onclick="switchAITab('forecast')" style="flex: 1; padding: 0.875rem 1.5rem; background: transparent; border: none; border-radius: 12px; color: #64748b; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s;">
              <i data-lucide="calendar" style="width: 18px; height: 18px;"></i>
              30-Day Forecast
            </button>
          </div>
          
          <!-- TAB 1: Revenue Predictions -->
          <div id="ai-tab-predictions" class="ai-tab-content" style="margin-top: 1.5rem;">
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
              
              <!-- Main Prediction Chart -->
              <div style="background: white; border-radius: 20px; border: 1px solid #e2e8f0; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.06);">
                <div style="padding: 1.5rem; border-bottom: 1px solid #f1f5f9;">
                  <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div>
                      <h3 style="font-size: 1.125rem; font-weight: 700; color: #1e293b; margin: 0;">Revenue Prediction Model</h3>
                      <p style="font-size: 0.85rem; color: #64748b; margin: 0.25rem 0 0;">AI-powered forecast with 94.7% confidence interval</p>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                      <span style="padding: 0.375rem 0.875rem; background: #eff6ff; border-radius: 8px; font-size: 0.75rem; font-weight: 600; color: #3b82f6;">Historical</span>
                      <span style="padding: 0.375rem 0.875rem; background: linear-gradient(135deg, #dcfce7, #bbf7d0); border-radius: 8px; font-size: 0.75rem; font-weight: 600; color: #16a34a;">Predicted</span>
                    </div>
                  </div>
                </div>
                <div style="padding: 1.5rem;">
                  <div style="height: 320px;">
                    <canvas id="aiPredictionChart"></canvas>
                  </div>
                </div>
                
                <!-- Prediction Summary -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; padding: 1.25rem; background: linear-gradient(135deg, #f8fafc, #f1f5f9); border-top: 1px solid #e2e8f0;">
                  <div style="text-align: center; padding: 1rem; background: white; border-radius: 12px; border: 1px solid #e2e8f0;">
                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 0.25rem;">Current Month</div>
                    <div style="font-size: 1.25rem; font-weight: 800; color: #1e293b;">$2.85M</div>
                    <div style="font-size: 0.7rem; color: #10b981; margin-top: 0.25rem;">‚Üë 12.4% vs last month</div>
                  </div>
                  <div style="text-align: center; padding: 1rem; background: white; border-radius: 12px; border: 1px solid #e2e8f0;">
                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 0.25rem;">Next Month Prediction</div>
                    <div style="font-size: 1.25rem; font-weight: 800; color: #10b981;">$3.24M</div>
                    <div style="font-size: 0.7rem; color: #10b981; margin-top: 0.25rem;">‚Üë 13.7% predicted growth</div>
                  </div>
                  <div style="text-align: center; padding: 1rem; background: white; border-radius: 12px; border: 1px solid #e2e8f0;">
                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 0.25rem;">Q2 2025 Forecast</div>
                    <div style="font-size: 1.25rem; font-weight: 800; color: #3b82f6;">$9.8M</div>
                    <div style="font-size: 0.7rem; color: #3b82f6; margin-top: 0.25rem;">High confidence</div>
                  </div>
                  <div style="text-align: center; padding: 1rem; background: white; border-radius: 12px; border: 1px solid #e2e8f0;">
                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 0.25rem;">Annual Projection</div>
                    <div style="font-size: 1.25rem; font-weight: 800; color: #8b5cf6;">$38.5M</div>
                    <div style="font-size: 0.7rem; color: #8b5cf6; margin-top: 0.25rem;">+24% YoY growth</div>
                  </div>
                </div>
              </div>
              
              <!-- Prediction Insights Sidebar -->
              <div style="display: flex; flex-direction: column; gap: 1rem;">
                
                <!-- AI Confidence Score -->
                <div style="background: linear-gradient(135deg, #0f172a, #1e293b); border-radius: 16px; padding: 1.5rem; color: white;">
                  <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <i data-lucide="shield-check" style="width: 20px; height: 20px;"></i>
                    </div>
                    <div>
                      <div style="font-size: 0.8rem; color: rgba(255,255,255,0.6);">Model Confidence</div>
                      <div style="font-size: 1.5rem; font-weight: 800;">94.7%</div>
                    </div>
                  </div>
                  <div style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                    <div style="height: 100%; width: 94.7%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 4px;"></div>
                  </div>
                  <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.75rem;">Based on 2.4M data points from the last 24 months</p>
                </div>
                
                <!-- Key Drivers -->
                <div style="background: white; border-radius: 16px; border: 1px solid #e2e8f0; padding: 1.25rem; flex: 1;">
                  <h4 style="font-size: 0.9rem; font-weight: 700; color: #1e293b; margin: 0 0 1rem;">Key Growth Drivers</h4>
                  
                  <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                    <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: #f8fafc; border-radius: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #dcfce7, #bbf7d0); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="users" style="width: 18px; height: 18px; color: #16a34a;"></i>
                      </div>
                      <div style="flex: 1;">
                        <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">New Customer Acquisition</div>
                        <div style="font-size: 0.75rem; color: #64748b;">+18% contribution</div>
                      </div>
                      <span style="font-size: 0.85rem; font-weight: 700; color: #16a34a;">‚Üë 32%</span>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: #f8fafc; border-radius: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #dbeafe, #bfdbfe); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="repeat" style="width: 18px; height: 18px; color: #2563eb;"></i>
                      </div>
                      <div style="flex: 1;">
                        <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">Repeat Purchase Rate</div>
                        <div style="font-size: 0.75rem; color: #64748b;">+15% contribution</div>
                      </div>
                      <span style="font-size: 0.85rem; font-weight: 700; color: #2563eb;">‚Üë 28%</span>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; background: #f8fafc; border-radius: 10px;">
                      <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <i data-lucide="shopping-cart" style="width: 18px; height: 18px; color: #d97706;"></i>
                      </div>
                      <div style="flex: 1;">
                        <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">Average Order Value</div>
                        <div style="font-size: 0.75rem; color: #64748b;">+12% contribution</div>
                      </div>
                      <span style="font-size: 0.85rem; font-weight: 700; color: #d97706;">‚Üë 15%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- TAB 2: Smart Recommendations -->
          <div id="ai-tab-recommendations" class="ai-tab-content" style="margin-top: 1.5rem; display: none;">
            
            <!-- Priority Actions Banner -->
            <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b; border-radius: 16px; padding: 1.25rem; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 1rem;">
              <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 12px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <i data-lucide="alert-circle" style="width: 24px; height: 24px; color: white;"></i>
              </div>
              <div style="flex: 1;">
                <h4 style="font-size: 1rem; font-weight: 700; color: #92400e; margin: 0;">3 High-Priority Actions Require Attention</h4>
                <p style="font-size: 0.85rem; color: #a16207; margin: 0.25rem 0 0;">Taking action on these recommendations could generate an additional $127,500 in revenue this month.</p>
              </div>
              <button style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, #f59e0b, #d97706); border: none; border-radius: 10px; color: white; font-weight: 600; cursor: pointer; white-space: nowrap;">View All Actions</button>
            </div>
            
            <!-- Recommendations Grid -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.25rem;">
              
              <!-- Recommendation Card 1 - Inventory -->
              <div style="background: white; border-radius: 20px; border: 2px solid #dcfce7; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.06); transition: all 0.3s;">
                <div style="padding: 1.5rem;">
                  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <span style="padding: 0.375rem 0.875rem; background: linear-gradient(135deg, #dcfce7, #bbf7d0); border-radius: 20px; font-size: 0.7rem; font-weight: 700; color: #16a34a; text-transform: uppercase; letter-spacing: 0.05em;">HIGH OPPORTUNITY</span>
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <i data-lucide="package" style="width: 18px; height: 18px; color: white;"></i>
                    </div>
                  </div>
                  <h4 style="font-size: 1.1rem; font-weight: 700; color: #1e293b; margin: 0 0 0.5rem;">Increase Brake Pads Stock</h4>
                  <p style="font-size: 0.85rem; color: #64748b; line-height: 1.6; margin: 0 0 1rem;">AI analysis predicts 35% demand surge next month based on seasonal patterns and market trends.</p>
                  
                  <div style="background: #f8fafc; border-radius: 12px; padding: 1rem; margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                      <span style="font-size: 0.8rem; color: #64748b;">Confidence Score</span>
                      <span style="font-size: 0.8rem; font-weight: 700; color: #10b981;">92%</span>
                    </div>
                    <div style="height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden;">
                      <div style="height: 100%; width: 92%; background: linear-gradient(90deg, #10b981, #34d399); border-radius: 3px;"></div>
                    </div>
                  </div>
                  
                  <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 1rem; border-top: 1px solid #f1f5f9;">
                    <div>
                      <div style="font-size: 0.75rem; color: #64748b;">Potential Revenue</div>
                      <div style="font-size: 1.25rem; font-weight: 800; color: #10b981;">+$42,500</div>
                    </div>
                    <button style="padding: 0.625rem 1.25rem; background: linear-gradient(135deg, #10b981, #059669); border: none; border-radius: 8px; color: white; font-size: 0.85rem; font-weight: 600; cursor: pointer;">Take Action</button>
                  </div>
                </div>
              </div>
              
              <!-- Recommendation Card 2 - Customer Retention -->
              <div style="background: white; border-radius: 20px; border: 2px solid #fef3c7; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.06); transition: all 0.3s;">
                <div style="padding: 1.5rem;">
                  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <span style="padding: 0.375rem 0.875rem; background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 20px; font-size: 0.7rem; font-weight: 700; color: #d97706; text-transform: uppercase; letter-spacing: 0.05em;">URGENT ACTION</span>
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <i data-lucide="users" style="width: 18px; height: 18px; color: white;"></i>
                    </div>
                  </div>
                  <h4 style="font-size: 1.1rem; font-weight: 700; color: #1e293b; margin: 0 0 0.5rem;">Re-engage Top Customers</h4>
                  <p style="font-size: 0.85rem; color: #64748b; line-height: 1.6; margin: 0 0 1rem;">3 high-value customers haven't ordered in 15+ days. Personalized outreach recommended.</p>
                  
                  <div style="background: #f8fafc; border-radius: 12px; padding: 1rem; margin-bottom: 1rem;">
                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 0.5rem;">At-Risk Customers</div>
                    <div style="display: flex; gap: 0.5rem;">
                      <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #3b82f6, #2563eb); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 700; color: white;">AC</div>
                      <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 700; color: white;">PM</div>
                      <div style="width: 32px; height: 32px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 700; color: white;">FF</div>
                    </div>
                  </div>
                  
                  <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 1rem; border-top: 1px solid #f1f5f9;">
                    <div>
                      <div style="font-size: 0.75rem; color: #64748b;">At-Risk Revenue</div>
                      <div style="font-size: 1.25rem; font-weight: 800; color: #f59e0b;">$127,000</div>
                    </div>
                    <button style="padding: 0.625rem 1.25rem; background: linear-gradient(135deg, #f59e0b, #d97706); border: none; border-radius: 8px; color: white; font-size: 0.85rem; font-weight: 600; cursor: pointer;">Send Offers</button>
                  </div>
                </div>
              </div>
              
              <!-- Recommendation Card 3 - Cross-Sell -->
              <div style="background: white; border-radius: 20px; border: 2px solid #ede9fe; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.06); transition: all 0.3s;">
                <div style="padding: 1.5rem;">
                  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <span style="padding: 0.375rem 0.875rem; background: linear-gradient(135deg, #ede9fe, #ddd6fe); border-radius: 20px; font-size: 0.7rem; font-weight: 700; color: #7c3aed; text-transform: uppercase; letter-spacing: 0.05em;">CROSS-SELL</span>
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                      <i data-lucide="gift" style="width: 18px; height: 18px; color: white;"></i>
                    </div>
                  </div>
                  <h4 style="font-size: 1.1rem; font-weight: 700; color: #1e293b; margin: 0 0 0.5rem;">Create Oil Filter Bundle</h4>
                  <p style="font-size: 0.85rem; color: #64748b; line-height: 1.6; margin: 0 0 1rem;">78% of oil filter buyers also purchase engine oil. Bundle discount could boost conversions.</p>
                  
                  <div style="background: #f8fafc; border-radius: 12px; padding: 1rem; margin-bottom: 1rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                      <span style="font-size: 0.8rem; color: #64748b;">Correlation Strength</span>
                      <span style="font-size: 0.8rem; font-weight: 700; color: #8b5cf6;">78%</span>
                    </div>
                    <div style="height: 6px; background: #e2e8f0; border-radius: 3px; overflow: hidden;">
                      <div style="height: 100%; width: 78%; background: linear-gradient(90deg, #8b5cf6, #a78bfa); border-radius: 3px;"></div>
                    </div>
                  </div>
                  
                  <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 1rem; border-top: 1px solid #f1f5f9;">
                    <div>
                      <div style="font-size: 0.75rem; color: #64748b;">Conversion Boost</div>
                      <div style="font-size: 1.25rem; font-weight: 800; color: #8b5cf6;">+23%</div>
                    </div>
                    <button style="padding: 0.625rem 1.25rem; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border: none; border-radius: 8px; color: white; font-size: 0.85rem; font-weight: 600; cursor: pointer;">Create Bundle</button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Additional Recommendations -->
            <div style="margin-top: 1.5rem; background: white; border-radius: 20px; border: 1px solid #e2e8f0; overflow: hidden;">
              <div style="padding: 1.25rem; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; justify-content: space-between;">
                <h4 style="font-size: 1rem; font-weight: 700; color: #1e293b; margin: 0;">More AI Recommendations</h4>
                <span style="font-size: 0.8rem; color: #64748b;">9 more insights available</span>
              </div>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr);">
                <div style="padding: 1.25rem; border-right: 1px solid #f1f5f9; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; gap: 1rem;">
                  <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #dbeafe, #bfdbfe); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="truck" style="width: 22px; height: 22px; color: #2563eb;"></i>
                  </div>
                  <div style="flex: 1;">
                    <div style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Optimize Shipping Routes</div>
                    <div style="font-size: 0.8rem; color: #64748b;">Save $8,200/month on logistics</div>
                  </div>
                  <span style="padding: 0.25rem 0.625rem; background: #dbeafe; border-radius: 6px; font-size: 0.7rem; font-weight: 600; color: #2563eb;">LOGISTICS</span>
                </div>
                <div style="padding: 1.25rem; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; gap: 1rem;">
                  <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #fce7f3, #fbcfe8); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="percent" style="width: 22px; height: 22px; color: #db2777;"></i>
                  </div>
                  <div style="flex: 1;">
                    <div style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Dynamic Pricing Opportunity</div>
                    <div style="font-size: 0.8rem; color: #64748b;">Increase margins by 4.5%</div>
                  </div>
                  <span style="padding: 0.25rem 0.625rem; background: #fce7f3; border-radius: 6px; font-size: 0.7rem; font-weight: 600; color: #db2777;">PRICING</span>
                </div>
                <div style="padding: 1.25rem; border-right: 1px solid #f1f5f9; display: flex; align-items: center; gap: 1rem;">
                  <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #ccfbf1, #99f6e4); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="target" style="width: 22px; height: 22px; color: #0d9488;"></i>
                  </div>
                  <div style="flex: 1;">
                    <div style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Target New Market Segment</div>
                    <div style="font-size: 0.8rem; color: #64748b;">$156K potential in fleet services</div>
                  </div>
                  <span style="padding: 0.25rem 0.625rem; background: #ccfbf1; border-radius: 6px; font-size: 0.7rem; font-weight: 600; color: #0d9488;">EXPANSION</span>
                </div>
                <div style="padding: 1.25rem; display: flex; align-items: center; gap: 1rem;">
                  <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="clock" style="width: 22px; height: 22px; color: #d97706;"></i>
                  </div>
                  <div style="flex: 1;">
                    <div style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Reduce Response Time</div>
                    <div style="font-size: 0.8rem; color: #64748b;">Improve satisfaction by 12%</div>
                  </div>
                  <span style="padding: 0.25rem 0.625rem; background: #fef3c7; border-radius: 6px; font-size: 0.7rem; font-weight: 600; color: #d97706;">SERVICE</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- TAB 3: Anomaly Detection -->
          <div id="ai-tab-anomalies" class="ai-tab-content" style="margin-top: 1.5rem; display: none;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
              
              <!-- Anomaly Chart -->
              <div style="background: white; border-radius: 20px; border: 1px solid #e2e8f0; overflow: hidden;">
                <div style="padding: 1.5rem; border-bottom: 1px solid #f1f5f9;">
                  <h3 style="font-size: 1.125rem; font-weight: 700; color: #1e293b; margin: 0;">Real-Time Anomaly Detection</h3>
                  <p style="font-size: 0.85rem; color: #64748b; margin: 0.25rem 0 0;">AI monitors 47 metrics for unusual patterns</p>
                </div>
                <div style="padding: 1.5rem;">
                  <div style="height: 280px;">
                    <canvas id="aiAnomalyChart"></canvas>
                  </div>
                </div>
              </div>
              
              <!-- Detected Anomalies List -->
              <div style="background: white; border-radius: 20px; border: 1px solid #e2e8f0; overflow: hidden;">
                <div style="padding: 1.5rem; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; justify-content: space-between;">
                  <div>
                    <h3 style="font-size: 1.125rem; font-weight: 700; color: #1e293b; margin: 0;">Detected Anomalies</h3>
                    <p style="font-size: 0.85rem; color: #64748b; margin: 0.25rem 0 0;">Last 24 hours</p>
                  </div>
                  <span style="padding: 0.375rem 0.875rem; background: #fef2f2; border-radius: 20px; font-size: 0.8rem; font-weight: 600; color: #dc2626;">3 Active</span>
                </div>
                <div style="max-height: 320px; overflow-y: auto;">
                  
                  <!-- Anomaly Item 1 - Critical -->
                  <div style="padding: 1.25rem; border-bottom: 1px solid #f1f5f9; display: flex; gap: 1rem;">
                    <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #fef2f2, #fecaca); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                      <i data-lucide="alert-triangle" style="width: 22px; height: 22px; color: #dc2626;"></i>
                    </div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                        <span style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Unusual Order Spike</span>
                        <span style="padding: 0.125rem 0.5rem; background: #fef2f2; border-radius: 4px; font-size: 0.65rem; font-weight: 700; color: #dc2626;">CRITICAL</span>
                      </div>
                      <p style="font-size: 0.8rem; color: #64748b; margin: 0;">Orders from IP range 192.168.x.x increased 340% - possible bot activity</p>
                      <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 0.5rem;">Detected 23 minutes ago</div>
                    </div>
                    <button style="padding: 0.5rem 1rem; background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; color: #dc2626; font-size: 0.8rem; font-weight: 600; cursor: pointer; white-space: nowrap;">Investigate</button>
                  </div>
                  
                  <!-- Anomaly Item 2 - Warning -->
                  <div style="padding: 1.25rem; border-bottom: 1px solid #f1f5f9; display: flex; gap: 1rem;">
                    <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                      <i data-lucide="activity" style="width: 22px; height: 22px; color: #d97706;"></i>
                    </div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                        <span style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Cart Abandonment Surge</span>
                        <span style="padding: 0.125rem 0.5rem; background: #fef3c7; border-radius: 4px; font-size: 0.65rem; font-weight: 700; color: #d97706;">WARNING</span>
                      </div>
                      <p style="font-size: 0.8rem; color: #64748b; margin: 0;">Abandonment rate jumped to 78% (normal: 45%) - checkout issue suspected</p>
                      <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 0.5rem;">Detected 1 hour ago</div>
                    </div>
                    <button style="padding: 0.5rem 1rem; background: #fef3c7; border: 1px solid #fde68a; border-radius: 8px; color: #d97706; font-size: 0.8rem; font-weight: 600; cursor: pointer; white-space: nowrap;">Review</button>
                  </div>
                  
                  <!-- Anomaly Item 3 - Info -->
                  <div style="padding: 1.25rem; display: flex; gap: 1rem;">
                    <div style="width: 44px; height: 44px; background: linear-gradient(135deg, #dbeafe, #bfdbfe); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                      <i data-lucide="info" style="width: 22px; height: 22px; color: #2563eb;"></i>
                    </div>
                    <div style="flex: 1;">
                      <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">
                        <span style="font-size: 0.9rem; font-weight: 600; color: #1e293b;">Geographic Shift</span>
                        <span style="padding: 0.125rem 0.5rem; background: #dbeafe; border-radius: 4px; font-size: 0.65rem; font-weight: 700; color: #2563eb;">INFO</span>
                      </div>
                      <p style="font-size: 0.8rem; color: #64748b; margin: 0;">Traffic from UAE region increased 156% - marketing campaign effect</p>
                      <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 0.5rem;">Detected 3 hours ago</div>
                    </div>
                    <button style="padding: 0.5rem 1rem; background: #dbeafe; border: 1px solid #bfdbfe; border-radius: 8px; color: #2563eb; font-size: 0.8rem; font-weight: 600; cursor: pointer; white-space: nowrap;">Details</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- TAB 4: 30-Day Forecast -->
          <div id="ai-tab-forecast" class="ai-tab-content" style="margin-top: 1.5rem; display: none;">
            
            <!-- Forecast Summary Cards -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
              <div style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); border-radius: 16px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 0.8rem; color: #166534; margin-bottom: 0.5rem; font-weight: 600;">Projected Revenue</div>
                <div style="font-size: 2rem; font-weight: 800; color: #15803d;">$3.24M</div>
                <div style="font-size: 0.8rem; color: #16a34a; margin-top: 0.25rem;">‚Üë 13.7% vs current</div>
              </div>
              <div style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 16px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 0.8rem; color: #1e40af; margin-bottom: 0.5rem; font-weight: 600;">Expected Orders</div>
                <div style="font-size: 2rem; font-weight: 800; color: #1d4ed8;">2,847</div>
                <div style="font-size: 0.8rem; color: #2563eb; margin-top: 0.25rem;">‚Üë 156 more than avg</div>
              </div>
              <div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 16px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 0.8rem; color: #92400e; margin-bottom: 0.5rem; font-weight: 600;">New Customers</div>
                <div style="font-size: 2rem; font-weight: 800; color: #b45309;">342</div>
                <div style="font-size: 0.8rem; color: #d97706; margin-top: 0.25rem;">‚Üë 28% growth rate</div>
              </div>
              <div style="background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%); border-radius: 16px; padding: 1.5rem; text-align: center;">
                <div style="font-size: 0.8rem; color: #5b21b6; margin-bottom: 0.5rem; font-weight: 600;">Avg Order Value</div>
                <div style="font-size: 2rem; font-weight: 800; color: #7c3aed;">$1,138</div>
                <div style="font-size: 0.8rem; color: #8b5cf6; margin-top: 0.25rem;">‚Üë 5.2% increase</div>
              </div>
            </div>
            
            <!-- Forecast Chart -->
            <div style="background: white; border-radius: 20px; border: 1px solid #e2e8f0; overflow: hidden; margin-bottom: 1.5rem;">
              <div style="padding: 1.5rem; border-bottom: 1px solid #f1f5f9;">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <div>
                    <h3 style="font-size: 1.125rem; font-weight: 700; color: #1e293b; margin: 0;">30-Day Revenue Forecast</h3>
                    <p style="font-size: 0.85rem; color: #64748b; margin: 0.25rem 0 0;">Daily projections with confidence bands</p>
                  </div>
                  <div style="display: flex; gap: 0.75rem;">
                    <div style="display: flex; align-items: center; gap: 0.375rem;">
                      <div style="width: 12px; height: 12px; background: #3b82f6; border-radius: 2px;"></div>
                      <span style="font-size: 0.75rem; color: #64748b;">Forecast</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.375rem;">
                      <div style="width: 12px; height: 12px; background: rgba(59, 130, 246, 0.2); border-radius: 2px;"></div>
                      <span style="font-size: 0.75rem; color: #64748b;">Confidence Band</span>
                    </div>
                  </div>
                </div>
              </div>
              <div style="padding: 1.5rem;">
                <div style="height: 300px;">
                  <canvas id="aiForecastChart"></canvas>
                </div>
              </div>
            </div>
            
            <!-- Weekly Breakdown -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem;">
              <div style="background: white; border-radius: 16px; border: 1px solid #e2e8f0; padding: 1.25rem;">
                <div style="font-size: 0.8rem; color: #64748b; margin-bottom: 0.5rem;">Week 1 (Jan 9-15)</div>
                <div style="font-size: 1.5rem; font-weight: 800; color: #1e293b;">$756K</div>
                <div style="display: flex; align-items: center; gap: 0.25rem; margin-top: 0.5rem;">
                  <i data-lucide="trending-up" style="width: 14px; height: 14px; color: #10b981;"></i>
                  <span style="font-size: 0.8rem; color: #10b981; font-weight: 600;">+8.2%</span>
                </div>
              </div>
              <div style="background: white; border-radius: 16px; border: 1px solid #e2e8f0; padding: 1.25rem;">
                <div style="font-size: 0.8rem; color: #64748b; margin-bottom: 0.5rem;">Week 2 (Jan 16-22)</div>
                <div style="font-size: 1.5rem; font-weight: 800; color: #1e293b;">$812K</div>
                <div style="display: flex; align-items: center; gap: 0.25rem; margin-top: 0.5rem;">
                  <i data-lucide="trending-up" style="width: 14px; height: 14px; color: #10b981;"></i>
                  <span style="font-size: 0.8rem; color: #10b981; font-weight: 600;">+12.4%</span>
                </div>
              </div>
              <div style="background: white; border-radius: 16px; border: 1px solid #e2e8f0; padding: 1.25rem;">
                <div style="font-size: 0.8rem; color: #64748b; margin-bottom: 0.5rem;">Week 3 (Jan 23-29)</div>
                <div style="font-size: 1.5rem; font-weight: 800; color: #1e293b;">$845K</div>
                <div style="display: flex; align-items: center; gap: 0.25rem; margin-top: 0.5rem;">
                  <i data-lucide="trending-up" style="width: 14px; height: 14px; color: #10b981;"></i>
                  <span style="font-size: 0.8rem; color: #10b981; font-weight: 600;">+15.1%</span>
                </div>
              </div>
              <div style="background: white; border-radius: 16px; border: 1px solid #e2e8f0; padding: 1.25rem;">
                <div style="font-size: 0.8rem; color: #64748b; margin-bottom: 0.5rem;">Week 4 (Jan 30-Feb 5)</div>
                <div style="font-size: 1.5rem; font-weight: 800; color: #1e293b;">$827K</div>
                <div style="display: flex; align-items: center; gap: 0.25rem; margin-top: 0.5rem;">
                  <i data-lucide="trending-up" style="width: 14px; height: 14px; color: #10b981;"></i>
                  <span style="font-size: 0.8rem; color: #10b981; font-weight: 600;">+11.8%</span>
                </div>
              </div>
            </div>
          </div>
          
        </div>
        
        <style>
          @keyframes pulse { 0%, 100% { opacity: 0.5; transform: scale(1); } 50% { opacity: 0.8; transform: scale(1.05); } }
          @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
          @keyframes iconGlow { 0%, 100% { box-shadow: 0 8px 32px rgba(59, 130, 246, 0.4); } 50% { box-shadow: 0 8px 48px rgba(59, 130, 246, 0.6); } }
          .ai-tab.active { background: linear-gradient(135deg, #2b5278, #1e3a54) !important; color: white !important; }
          .ai-tab:hover:not(.active) { background: #f8fafc; color: #1e293b; }
        </style>

        <!-- Additional Charts Row -->
        <div class="admin-grid admin-grid-3" style="margin-bottom: 2rem;">
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title">Order Status</div>
                <div class="chart-subtitle">Current distribution</div>
              </div>
            </div>
            <div class="chart-container" style="height: 180px;">
              <canvas id="statusChart"></canvas>
            </div>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title">Weekly Orders</div>
                <div class="chart-subtitle">Last 7 days trend</div>
              </div>
            </div>
            <div class="chart-container" style="height: 180px;">
              <canvas id="weeklyChart"></canvas>
            </div>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title">Top Countries</div>
                <div class="chart-subtitle">By order volume</div>
              </div>
            </div>
            <div class="chart-container" style="height: 180px;">
              <canvas id="countriesChart"></canvas>
            </div>
          </div>
          <div class="chart-card">
            <div class="chart-header">
              <div>
                <div class="chart-title">Vehicle Brands</div>
                <div class="chart-subtitle">Top manufacturers</div>
              </div>
            </div>
            <div class="chart-container" style="height: 180px;">
            <canvas id="brandsChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Orders & Tickets Row -->
        <div style="display: grid; grid-template-columns: 1.5fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
          <!-- Recent Orders -->
          <div class="orders-card" style="margin-bottom: 0;">
          <div class="orders-header">
            <h3 class="orders-title">Recent Orders</h3>
            <a href="/admin/orders" class="admin-btn admin-btn-secondary">
              <i data-lucide="external-link"></i>
              View All
            </a>
          </div>
          <div class="orders-body">
            <% if (recentOrders.length === 0) { %>
              <div style="padding: 2rem; text-align: center; color: var(--admin-text-muted);">
                No orders found.
              </div>
            <% } else { %>
              <!-- Table Header -->
              <div style="display: flex; align-items: center; padding: 0.75rem 1rem; border-bottom: 2px solid var(--admin-border); background: var(--admin-bg-secondary); gap: 1rem;">
                <div style="min-width: 120px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px;">Order ID</div>
                <div style="flex: 1; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px;">Customer</div>
                <div style="min-width: 100px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px; text-align: right;">Amount</div>
                <div style="min-width: 110px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px;">Status</div>
                <div style="width: 76px; font-weight: 600; font-size: 0.7rem; text-transform: uppercase; color: var(--admin-text-muted); letter-spacing: 0.5px; text-align: center;">Actions</div>
              </div>
              <% recentOrders.slice(0, 6).forEach(function(order) { %>
                <div class="order-row" style="display: flex; align-items: center; padding: 0.875rem 1rem; border-bottom: 1px solid var(--admin-border); gap: 1rem;">
                  <div style="min-width: 120px; font-weight: 600; color: var(--module-primary); font-size: 0.85rem;"><%= order.id %></div>
                  <div style="flex: 1; font-weight: 500; color: var(--admin-text-primary);"><%= order.customer %></div>
                  <div style="min-width: 100px; font-weight: 700; color: var(--admin-text-primary); text-align: right;">$<%= order.amount.toLocaleString() %></div>
                  <div style="min-width: 110px; display: flex; align-items: center; gap: 0.4rem; padding: 0.35rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; background: <%= order.status === 'pending' ? 'rgba(245, 158, 11, 0.12)' : order.status === 'processing' ? 'rgba(59, 130, 246, 0.12)' : order.status === 'shipped' ? 'rgba(139, 92, 246, 0.12)' : 'rgba(16, 185, 129, 0.12)' %>; color: <%= order.status === 'pending' ? '#d97706' : order.status === 'processing' ? '#2563eb' : order.status === 'shipped' ? '#7c3aed' : '#059669' %>;">
                    <% if (order.status === 'pending') { %>
                      <i data-lucide="clock" style="width: 12px; height: 12px;"></i>
                    <% } else if (order.status === 'processing') { %>
                      <i data-lucide="loader" style="width: 12px; height: 12px;"></i>
                    <% } else if (order.status === 'shipped') { %>
                      <i data-lucide="truck" style="width: 12px; height: 12px;"></i>
                    <% } else { %>
                      <i data-lucide="check-circle" style="width: 12px; height: 12px;"></i>
                    <% } %>
                    <%= order.status.charAt(0).toUpperCase() + order.status.slice(1) %>
                  </div>
                  <div style="display: flex; gap: 0.5rem;">
                    <button style="width: 32px; height: 32px; border: 1px solid var(--admin-border); background: var(--admin-bg-primary); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--admin-text-muted); transition: all 0.2s;" title="View Details">
                      <i data-lucide="eye" style="width: 14px; height: 14px;"></i>
                    </button>
                    <button style="width: 32px; height: 32px; border: 1px solid var(--admin-border); background: var(--admin-bg-primary); border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--admin-text-muted); transition: all 0.2s;" title="Edit Order">
                      <i data-lucide="edit-2" style="width: 14px; height: 14px;"></i>
                    </button>
                  </div>
                </div>
              <% }); %>
            <% } %>
          </div>
          </div>
          
          <!-- Support Tickets -->
          <div class="activity-card" style="margin-bottom: 0;">
            <div class="activity-header">
              <h3 class="activity-title">Support Tickets</h3>
              <a href="/admin/tickets" class="admin-btn admin-btn-secondary">Manage</a>
            </div>
            <div class="activity-list" style="max-height: 300px; overflow-y: auto;">
              <% if (tickets.length === 0) { %>
                <div style="padding: 2rem; text-align: center; color: var(--admin-text-muted);">
                  No tickets found.
                </div>
              <% } else { %>
                <% tickets.slice(0, 5).forEach(function(ticket) { %>
                  <div class="activity-item" style="padding: 0.875rem;">
                    <div class="activity-icon <%= ticket.status === 'resolved' ? 'success' : ticket.status === 'open' ? 'warning' : '' %>">
                      <i data-lucide="<%= ticket.status === 'resolved' ? 'check-circle' : 'mail' %>"></i>
                    </div>
                    <div class="activity-content" style="flex: 1;">
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div class="activity-text"><strong><%= ticket.id %></strong></div>
                        <span style="font-size: 0.65rem; padding: 0.15rem 0.4rem; border-radius: 8px; background: <%= ticket.priority === 'urgent' ? 'rgba(239, 68, 68, 0.15)' : ticket.priority === 'high' ? 'rgba(245, 158, 11, 0.15)' : 'rgba(59, 130, 246, 0.15)' %>; color: <%= ticket.priority === 'urgent' ? '#dc2626' : ticket.priority === 'high' ? '#d97706' : '#3b82f6' %>;"><%= ticket.priority %></span>
                      </div>
                      <div class="activity-time"><%= ticket.subject.substring(0, 30) %><%= ticket.subject.length > 30 ? '...' : '' %></div>
                      <div style="font-size: 0.7rem; color: var(--admin-text-muted); margin-top: 0.25rem;">
                        <%= ticket.status.charAt(0).toUpperCase() + ticket.status.slice(1) %> ‚Ä¢ <%= ticket.category %>
                      </div>
                    </div>
                  </div>
                <% }); %>
              <% } %>
            </div>
          </div>
        </div>

        <!-- Activity Feed -->
        <div class="admin-grid admin-grid-2">
          <div class="activity-card">
            <div class="activity-header">
              <h3 class="activity-title">Recent Activity</h3>
              <button class="admin-btn admin-btn-secondary">View All</button>
            </div>
            <div class="activity-list">
              <% if (recentActivity && recentActivity.length > 0) { %>
                <% recentActivity.forEach(function(activity) { %>
                <div class="activity-item">
                  <div class="activity-icon <%= activity.iconClass %>">
                    <i data-lucide="<%= activity.icon %>"></i>
                  </div>
                  <div class="activity-content">
                    <div class="activity-text"><strong><%= activity.title %></strong> <%= activity.description %></div>
                    <div class="activity-time"><%= activity.timeAgo %></div>
                  </div>
                </div>
                <% }); %>
              <% } else { %>
                <div class="activity-item">
                  <div class="activity-icon">
                    <i data-lucide="info"></i>
                  </div>
                  <div class="activity-content">
                    <div class="activity-text">No recent activity found</div>
                    <div class="activity-time">Activity will appear here as you use the platform</div>
                  </div>
                </div>
              <% } %>
            </div>
          </div>

          <div class="activity-card">
            <div class="activity-header">
              <h3 class="activity-title">Top Selling Parts</h3>
              <a href="/admin/products" class="admin-btn admin-btn-secondary">View All</a>
            </div>
            <div class="activity-list">
              <% const sellPartColors = ['#10b981', '#3b82f6', '#8b5cf6', '#f59e0b', '#ec4899']; %>
              <% const sellPartIcons = ['award', 'trending-up', 'star', 'package', 'box']; %>
              <% if (topSellingParts && topSellingParts.length > 0) { %>
                <% topSellingParts.forEach(function(part, index) { %>
                <div class="activity-item" style="padding: 0.875rem;">
                  <div style="width: 40px; height: 40px; background: <%= sellPartColors[index % 5] %>1f; border-radius: 10px; display: flex; align-items: center; justify-content: center; color: <%= sellPartColors[index % 5] %>;">
                    <i data-lucide="<%= sellPartIcons[index % 5] %>"></i>
                  </div>
                  <div class="activity-content" style="flex: 1;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div class="activity-text" style="font-weight: 600;"><%= part.name.length > 25 ? part.name.substring(0, 25) + '...' : part.name %></div>
                      <span style="font-weight: 700; color: var(--module-primary);">$<%= part.revenue >= 1000 ? (part.revenue / 1000).toFixed(1) + 'K' : part.revenue.toLocaleString() %></span>
                    </div>
                    <div class="activity-time"><%= part.unitsSold %> units sold</div>
                  </div>
                </div>
                <% }); %>
              <% } else { %>
                <div class="activity-item" style="padding: 0.875rem;">
                  <div style="width: 40px; height: 40px; background: rgba(148, 163, 184, 0.12); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: #94a3b8;">
                    <i data-lucide="package"></i>
                  </div>
                  <div class="activity-content" style="flex: 1;">
                    <div class="activity-text" style="font-weight: 600;">No sales data yet</div>
                    <div class="activity-time">Top selling parts will appear here</div>
                  </div>
                </div>
              <% } %>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Charts Initialization -->
  <script>
    // Get module-themed color
    const moduleColor = getComputedStyle(document.documentElement).getPropertyValue('--module-primary').trim() || '#3b82f6';
    const currentModule = 'automotive'; // Single platform - automotive only

    // Revenue Chart - Automotive Styling
    const revenueCtx = document.getElementById('revenueChart').getContext('2d');
    
    // Define chart configuration for automotive
    const chartConfigs = {
      automotive: {
        type: 'bar',
        primaryColor: '#dc2626',
        secondaryColor: '#f97316',
        gradient: ['#dc2626', '#ef4444', '#f87171'],
        borderRadius: 8,
        barThickness: 24
      },
      default: {
        type: 'bar',
        primaryColor: '#dc2626',
        secondaryColor: '#f97316',
        gradient: ['#dc2626', '#ef4444', '#f87171'],
        borderRadius: 8,
        barThickness: 24
      },
      aviation: {
        type: 'line',
        primaryColor: '#0ea5e9',
        secondaryColor: '#6366f1',
        gradient: ['#0ea5e9', '#38bdf8', '#7dd3fc'],
        tension: 0.5,
        pointStyle: 'circle'
      },
      machinery: {
        type: 'bar',
        primaryColor: '#eab308',
        secondaryColor: '#84cc16',
        gradient: ['#eab308', '#facc15', '#fde047'],
        borderRadius: 4,
        barThickness: 20
      },
      default: {
        type: 'line',
        primaryColor: '#3b82f6',
        secondaryColor: '#8b5cf6',
        gradient: ['#3b82f6', '#60a5fa', '#93c5fd'],
        tension: 0.4,
        pointStyle: 'rectRounded'
      }
    };
    
    const config = chartConfigs[currentModule] || chartConfigs.default;
    
    // Create gradient for revenue
    const revenueGradient = revenueCtx.createLinearGradient(0, 0, 0, 300);
    revenueGradient.addColorStop(0, config.primaryColor + '40');
    revenueGradient.addColorStop(1, config.primaryColor + '05');
    
    // Real order count data from database
    const ordersData = <%- JSON.stringify(chartData.orderCountByMonth) %>;
    
    new Chart(revenueCtx, {
      type: config.type,
      data: {
        labels: <%- JSON.stringify(chartData.revenueLabels) %>,
        datasets: [{
          label: 'Platform Revenue ($K)',
          data: <%- JSON.stringify(chartData.revenueData.map(function(v) { return v / 1000; })) %>,
          borderColor: config.primaryColor,
          backgroundColor: config.type === 'bar' ? config.primaryColor : revenueGradient,
          fill: config.type === 'line',
          tension: config.tension || 0,
          borderRadius: config.borderRadius || 0,
          barThickness: config.barThickness,
          pointBackgroundColor: config.primaryColor,
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: config.type === 'line' ? 5 : 0,
          pointStyle: config.pointStyle || 'circle',
          yAxisID: 'y',
          order: 2
        }, {
          label: 'Orders',
          data: ordersData,
          type: 'line',
          borderColor: config.secondaryColor,
          backgroundColor: 'transparent',
          borderDash: [5, 5],
          borderWidth: 2,
          tension: 0.4,
          pointBackgroundColor: config.secondaryColor,
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          pointRadius: 4,
          pointHoverRadius: 6,
          yAxisID: 'y1',
          order: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: { mode: 'index', intersect: false },
        plugins: { 
          legend: { 
            display: true, 
            position: 'top', 
            labels: { 
              usePointStyle: true, 
              padding: 20,
              font: { weight: '600' }
            } 
          },
          tooltip: {
            backgroundColor: 'rgba(30, 41, 59, 0.95)',
            titleFont: { size: 14, weight: '600' },
            bodyFont: { size: 13 },
            padding: 12,
            cornerRadius: 8,
            displayColors: true
          }
        },
        scales: {
          y: {
            type: 'linear',
            display: true,
            position: 'left',
            grid: { color: 'rgba(43, 82, 120, 0.06)' },
            ticks: { 
              color: '#64748b', 
              callback: value => '$' + value + 'K',
              font: { weight: '500' }
            }
          },
          y1: {
            type: 'linear',
            display: true,
            position: 'right',
            grid: { drawOnChartArea: false },
            ticks: { 
              color: config.secondaryColor,
              font: { weight: '500' }
            }
          },
          x: {
            grid: { display: false },
            ticks: { 
              color: '#64748b',
              font: { weight: '500' }
            }
          }
        }
      }
    });

    // Orders/Status Distribution Chart
    const ordersCtx = document.getElementById('ordersChart').getContext('2d');
    new Chart(ordersCtx, {
      type: 'doughnut',
      data: {
        labels: ['Pending', 'Processing', 'Shipped', 'Completed'],
        datasets: [{
          data: <%- JSON.stringify(chartData.statusData) %>,
          backgroundColor: ['#f59e0b', '#3b82f6', '#8b5cf6', '#10b981'],
          borderWidth: 0,
          hoverOffset: 10
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        cutout: '65%'
      }
    });

    // Status Chart
    const statusCtx = document.getElementById('statusChart').getContext('2d');
    new Chart(statusCtx, {
      type: 'bar',
      data: {
        labels: ['Pending', 'Processing', 'Shipped', 'Delivered'],
        datasets: [{
          data: <%- JSON.stringify(chartData.statusData) %>,
          backgroundColor: ['#f59e0b', '#3b82f6', '#8b5cf6', '#10b981'],
          borderRadius: 6
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          y: { display: false },
          x: { grid: { display: false }, ticks: { color: '#64748b', font: { size: 10 } } }
        }
      }
    });

    // Weekly Chart
    const weeklyCtx = document.getElementById('weeklyChart').getContext('2d');
    new Chart(weeklyCtx, {
      type: 'line',
      data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
          data: [35, 42, 38, 55, 48, 32, 28],
          borderColor: moduleColor,
          backgroundColor: moduleColor + '20',
          fill: true,
          tension: 0.4,
          pointRadius: 3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          y: { display: false },
          x: { grid: { display: false }, ticks: { color: '#64748b', font: { size: 10 } } }
        }
      }
    });

    // Countries Chart - Real data from buyer countries
    <%
      const countryChartData = typeof ordersByCountry !== 'undefined' && ordersByCountry.length > 0 
        ? ordersByCountry.slice(0, 5) 
        : [{ name: 'No data', orderCount: 0 }];
      const countryLabels = countryChartData.map(c => c.name);
      const countryValues = countryChartData.map(c => c.orderCount);
    %>
    const countriesCtx = document.getElementById('countriesChart').getContext('2d');
    new Chart(countriesCtx, {
      type: 'bar',
      data: {
        labels: <%- JSON.stringify(countryLabels) %>,
        datasets: [{
          data: <%- JSON.stringify(countryValues) %>,
          backgroundColor: ['#0ea5e9', '#10b981', '#8b5cf6', '#f59e0b', '#ec4899'],
          borderRadius: 6
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { display: false },
          y: { grid: { display: false }, ticks: { color: '#64748b', font: { size: 11, weight: '500' } } }
        }
      }
    });

    // Vehicle Brands Chart
    const brandsCtx = document.getElementById('brandsChart').getContext('2d');
    new Chart(brandsCtx, {
      type: 'bar',
      data: {
        labels: ['BMW', 'Mercedes', 'Audi', 'Toyota', 'Ford'],
        datasets: [{
          data: [89, 76, 65, 54, 48],
          backgroundColor: '#dc2626',
          borderRadius: 4
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { display: false },
          y: { grid: { display: false }, ticks: { color: '#64748b', font: { size: 10 } } }
        }
      }
    });

    // ====================================
    // AI INTELLIGENCE HUB CHARTS & FUNCTIONS
    // ====================================
    
    // Tab Switching Function
    function switchAITab(tabName) {
      // Hide all tab contents
      document.querySelectorAll('.ai-tab-content').forEach(content => {
        content.style.display = 'none';
      });
      
      // Remove active class from all tabs
      document.querySelectorAll('.ai-tab').forEach(tab => {
        tab.classList.remove('active');
        tab.style.background = 'transparent';
        tab.style.color = '#64748b';
      });
      
      // Show selected tab content
      const selectedContent = document.getElementById('ai-tab-' + tabName);
      if (selectedContent) {
        selectedContent.style.display = 'block';
      }
      
      // Add active class to clicked tab
      event.target.closest('.ai-tab').classList.add('active');
      event.target.closest('.ai-tab').style.background = 'linear-gradient(135deg, #2b5278, #1e3a54)';
      event.target.closest('.ai-tab').style.color = 'white';
      
      // Initialize charts for the tab if needed
      if (tabName === 'predictions' && !window.aiPredictionChartInitialized) {
        initAIPredictionChart();
        window.aiPredictionChartInitialized = true;
      }
      if (tabName === 'anomalies' && !window.aiAnomalyChartInitialized) {
        initAIAnomalyChart();
        window.aiAnomalyChartInitialized = true;
      }
      if (tabName === 'forecast' && !window.aiForecastChartInitialized) {
        initAIForecastChart();
        window.aiForecastChartInitialized = true;
      }
    }
    
    // AI Prediction Chart
    function initAIPredictionChart() {
      const ctx = document.getElementById('aiPredictionChart');
      if (!ctx) return;
      
      const predictionCtx = ctx.getContext('2d');
      
      // Historical data (actual)
      const historicalData = [1850, 1920, 2100, 2250, 2180, 2350, 2480, 2520, 2650, 2780, 2850, null, null, null];
      // Predicted data
      const predictedData = [null, null, null, null, null, null, null, null, null, null, 2850, 2980, 3120, 3240];
      // Upper confidence band
      const upperBand = [null, null, null, null, null, null, null, null, null, null, 2850, 3080, 3250, 3400];
      // Lower confidence band
      const lowerBand = [null, null, null, null, null, null, null, null, null, null, 2850, 2880, 2990, 3080];
      
      const gradient = predictionCtx.createLinearGradient(0, 0, 0, 300);
      gradient.addColorStop(0, 'rgba(59, 130, 246, 0.2)');
      gradient.addColorStop(1, 'rgba(59, 130, 246, 0.02)');
      
      const predictedGradient = predictionCtx.createLinearGradient(0, 0, 0, 300);
      predictedGradient.addColorStop(0, 'rgba(16, 185, 129, 0.3)');
      predictedGradient.addColorStop(1, 'rgba(16, 185, 129, 0.02)');
      
      new Chart(predictionCtx, {
        type: 'line',
        data: {
          labels: ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Now', 'Feb', 'Mar', 'Apr'],
          datasets: [
            {
              label: 'Upper Confidence',
              data: upperBand,
              borderColor: 'rgba(16, 185, 129, 0.3)',
              backgroundColor: 'transparent',
              borderWidth: 1,
              borderDash: [5, 5],
              pointRadius: 0,
              fill: false
            },
            {
              label: 'Lower Confidence',
              data: lowerBand,
              borderColor: 'rgba(16, 185, 129, 0.3)',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              borderWidth: 1,
              borderDash: [5, 5],
              pointRadius: 0,
              fill: '-1'
            },
            {
              label: 'Historical Revenue ($K)',
              data: historicalData,
              borderColor: '#3b82f6',
              backgroundColor: gradient,
              borderWidth: 3,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: '#3b82f6',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7
            },
            {
              label: 'Predicted Revenue ($K)',
              data: predictedData,
              borderColor: '#10b981',
              backgroundColor: predictedGradient,
              borderWidth: 3,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: '#10b981',
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: 5,
              pointHoverRadius: 7
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: 'index', intersect: false },
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(30, 41, 59, 0.95)',
              titleFont: { size: 14, weight: '600' },
              bodyFont: { size: 13 },
              padding: 12,
              cornerRadius: 8,
              callbacks: {
                label: function(context) {
                  if (context.dataset.label.includes('Confidence')) return null;
                  return context.dataset.label + ': $' + context.parsed.y + 'K';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              min: 1500,
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { 
                color: '#64748b',
                callback: value => '$' + value + 'K',
                font: { weight: '500' }
              }
            },
            x: {
              grid: { display: false },
              ticks: { color: '#64748b', font: { weight: '500' } }
            }
          }
        }
      });
    }
    
    // AI Anomaly Chart
    function initAIAnomalyChart() {
      const ctx = document.getElementById('aiAnomalyChart');
      if (!ctx) return;
      
      const anomalyCtx = ctx.getContext('2d');
      
      // Normal range
      const normalData = [45, 48, 52, 47, 51, 49, 53, 48, 50, 52, 47, 49, 51, 48, 52, 180, 55, 51, 48, 53, 49, 47, 52, 50];
      
      // Highlight anomalies
      const anomalyPoints = normalData.map((val, idx) => val > 100 ? val : null);
      
      new Chart(anomalyCtx, {
        type: 'line',
        data: {
          labels: Array.from({length: 24}, (_, i) => i + 'h'),
          datasets: [
            {
              label: 'Normal Range (Upper)',
              data: Array(24).fill(70),
              borderColor: 'rgba(239, 68, 68, 0.3)',
              backgroundColor: 'transparent',
              borderWidth: 1,
              borderDash: [5, 5],
              pointRadius: 0,
              fill: false
            },
            {
              label: 'Normal Range (Lower)',
              data: Array(24).fill(30),
              borderColor: 'rgba(239, 68, 68, 0.3)',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              borderWidth: 1,
              borderDash: [5, 5],
              pointRadius: 0,
              fill: '-1'
            },
            {
              label: 'Orders/Hour',
              data: normalData,
              borderColor: '#3b82f6',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              borderWidth: 2,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: normalData.map(val => val > 100 ? '#ef4444' : '#3b82f6'),
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              pointRadius: normalData.map(val => val > 100 ? 8 : 3),
              pointHoverRadius: 6
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(30, 41, 59, 0.95)',
              callbacks: {
                label: function(context) {
                  const val = context.parsed.y;
                  if (val > 100) return '‚ö†Ô∏è ANOMALY: ' + val + ' orders (340% above normal)';
                  return 'Orders: ' + val;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { color: '#64748b' }
            },
            x: {
              grid: { display: false },
              ticks: { color: '#64748b' }
            }
          }
        }
      });
    }
    
    // AI Forecast Chart
    function initAIForecastChart() {
      const ctx = document.getElementById('aiForecastChart');
      if (!ctx) return;
      
      const forecastCtx = ctx.getContext('2d');
      
      // Generate 30 days of forecast data
      const days = Array.from({length: 30}, (_, i) => 'Jan ' + (9 + i));
      const forecastData = [95, 102, 98, 105, 112, 108, 75, 88, 115, 122, 118, 125, 130, 72, 95, 128, 135, 132, 140, 145, 78, 98, 142, 148, 145, 152, 158, 85, 105, 155];
      const upperBand = forecastData.map(v => v * 1.15);
      const lowerBand = forecastData.map(v => v * 0.85);
      
      const gradient = forecastCtx.createLinearGradient(0, 0, 0, 280);
      gradient.addColorStop(0, 'rgba(59, 130, 246, 0.3)');
      gradient.addColorStop(1, 'rgba(59, 130, 246, 0.02)');
      
      new Chart(forecastCtx, {
        type: 'line',
        data: {
          labels: days,
          datasets: [
            {
              label: 'Upper Band',
              data: upperBand,
              borderColor: 'rgba(59, 130, 246, 0.2)',
              backgroundColor: 'transparent',
              borderWidth: 1,
              pointRadius: 0,
              fill: false
            },
            {
              label: 'Lower Band',
              data: lowerBand,
              borderColor: 'rgba(59, 130, 246, 0.2)',
              backgroundColor: 'rgba(59, 130, 246, 0.1)',
              borderWidth: 1,
              pointRadius: 0,
              fill: '-1'
            },
            {
              label: 'Daily Revenue ($K)',
              data: forecastData,
              borderColor: '#3b82f6',
              backgroundColor: gradient,
              borderWidth: 2,
              fill: true,
              tension: 0.3,
              pointBackgroundColor: '#3b82f6',
              pointBorderColor: '#fff',
              pointBorderWidth: 1,
              pointRadius: 2,
              pointHoverRadius: 5
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(30, 41, 59, 0.95)',
              callbacks: {
                label: function(context) {
                  if (context.dataset.label.includes('Band')) return null;
                  return 'Forecast: $' + context.parsed.y + 'K';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: false,
              grid: { color: 'rgba(0, 0, 0, 0.05)' },
              ticks: { 
                color: '#64748b',
                callback: value => '$' + value + 'K'
              }
            },
            x: {
              grid: { display: false },
              ticks: { 
                color: '#64748b',
                maxRotation: 45,
                minRotation: 45,
                maxTicksLimit: 15
              }
            }
          }
        }
      });
    }
    
    // Initialize first tab chart on load
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        initAIPredictionChart();
        window.aiPredictionChartInitialized = true;
      }, 500);
    });
    
  </script>

<%- include('partials/footer') %>
