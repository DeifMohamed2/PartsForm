<%- include('partials/header') %>
<%- include('partials/navbar-simple', { showLogin: true, showRegister: true }) %>
<%- include('partials/login-modal') %>

<!-- ====================================
     FORGOT PASSWORD PAGE - CLEAN PROFESSIONAL DESIGN
     ==================================== -->
<section class="forgot-password-section">
  <div class="container forgot-container">
    <!-- Progress Steps -->
    <div class="progress-steps">
      <div class="progress-step active" data-step="1">
        <div class="step-number">1</div>
        <span class="step-label">Email</span>
      </div>
      <div class="progress-line"></div>
      <div class="progress-step" data-step="2">
        <div class="step-number">2</div>
        <span class="step-label">Verify</span>
      </div>
      <div class="progress-line"></div>
      <div class="progress-step" data-step="3">
        <div class="step-number">3</div>
        <span class="step-label">Reset</span>
      </div>
      <div class="progress-line"></div>
      <div class="progress-step" data-step="4">
        <div class="step-number">4</div>
        <span class="step-label">Done</span>
      </div>
    </div>

    <!-- Forgot Password Form -->
    <div class="forgot-form-wrapper">
      <div class="forgot-card">
        
        <!-- Step 1: Enter Email -->
        <div class="step-content active" id="step1">
          <div class="forgot-card-header">
            <div class="header-logo">
              <img src="/images/PARTSFORM-LOGO.webp" alt="PartsForm" class="logo-img">
            </div>
            <h2>Forgot Password?</h2>
            <p>No worries! Enter your email address and we'll send you a verification code.</p>
          </div>

          <!-- Error Message Display -->
          <div class="form-message form-error" id="step1Error" style="display: none;">
            <i data-lucide="alert-circle"></i>
            <span id="step1ErrorMessage"></span>
          </div>

          <form class="forgot-form" id="emailForm">
            <div class="form-group">
              <label for="email">Email Address</label>
              <div class="input-wrapper">
                <i data-lucide="mail" class="input-icon"></i>
                <input type="email" id="email" name="email" placeholder="you@company.com" required autocomplete="email">
              </div>
              <span class="field-error" id="emailError"></span>
            </div>

            <button type="submit" class="btn btn-primary btn-full" id="sendCodeBtn">
              <span class="btn-text">Send Verification Code</span>
              <span class="btn-loader" style="display: none;">
                <i data-lucide="loader-2" class="spin"></i>
                Sending...
              </span>
              <i data-lucide="arrow-right" class="btn-icon"></i>
            </button>
          </form>

          <div class="forgot-footer">
            <p>Remember your password? <a href="#" class="login-link" onclick="openLoginModal(); return false;">Sign In</a></p>
          </div>
        </div>

        <!-- Step 2: Enter Verification Code -->
        <div class="step-content" id="step2">
          <div class="forgot-card-header">
            <div class="header-logo">
              <img src="/images/PARTSFORM-LOGO.webp" alt="PartsForm" class="logo-img">
            </div>
            <h2>Check Your Email</h2>
            <p>We've sent a 6-digit verification code to:</p>
            <p class="email-display"><strong id="displayEmail"></strong></p>
          </div>

          <!-- Error Message Display -->
          <div class="form-message form-error" id="step2Error" style="display: none;">
            <i data-lucide="alert-circle"></i>
            <span id="step2ErrorMessage"></span>
          </div>

          <form class="forgot-form" id="verifyForm">
            <div class="form-group">
              <label for="verificationCode">Verification Code</label>
              <div class="code-input-wrapper">
                <input type="text" class="code-input" id="code1" maxlength="1" pattern="[0-9]" inputmode="numeric" autocomplete="one-time-code" autofocus>
                <input type="text" class="code-input" id="code2" maxlength="1" pattern="[0-9]" inputmode="numeric">
                <input type="text" class="code-input" id="code3" maxlength="1" pattern="[0-9]" inputmode="numeric">
                <span class="code-separator">-</span>
                <input type="text" class="code-input" id="code4" maxlength="1" pattern="[0-9]" inputmode="numeric">
                <input type="text" class="code-input" id="code5" maxlength="1" pattern="[0-9]" inputmode="numeric">
                <input type="text" class="code-input" id="code6" maxlength="1" pattern="[0-9]" inputmode="numeric">
              </div>
              <span class="field-error" id="codeError"></span>
            </div>

            <div class="timer-wrapper">
              <i data-lucide="clock"></i>
              <span>Code expires in <strong id="countdownTimer">15:00</strong></span>
            </div>

            <button type="submit" class="btn btn-primary btn-full" id="verifyCodeBtn">
              <span class="btn-text">Verify Code</span>
              <span class="btn-loader" style="display: none;">
                <i data-lucide="loader-2" class="spin"></i>
                Verifying...
              </span>
              <i data-lucide="check" class="btn-icon"></i>
            </button>
          </form>

          <div class="forgot-footer">
            <p>Didn't receive the code? <a href="#" class="resend-link" id="resendLink">Resend Code</a></p>
            <p class="mt-2"><a href="#" class="back-link" onclick="goToStep(1); return false;"><i data-lucide="arrow-left"></i> Change Email</a></p>
          </div>
        </div>

        <!-- Step 3: Reset Password -->
        <div class="step-content" id="step3">
          <div class="forgot-card-header">
            <div class="header-logo">
              <img src="/images/PARTSFORM-LOGO.webp" alt="PartsForm" class="logo-img">
            </div>
            <h2>Create New Password</h2>
            <p>Your identity has been verified. Set your new password below.</p>
          </div>

          <!-- Error Message Display -->
          <div class="form-message form-error" id="step3Error" style="display: none;">
            <i data-lucide="alert-circle"></i>
            <span id="step3ErrorMessage"></span>
          </div>

          <form class="forgot-form" id="resetForm">
            <div class="form-group">
              <label for="newPassword">New Password</label>
              <div class="input-wrapper password-wrapper">
                <i data-lucide="lock" class="input-icon"></i>
                <input type="password" id="newPassword" name="password" placeholder="Create a strong password" required minlength="8">
                <button type="button" class="password-toggle" onclick="togglePassword('newPassword')">
                  <i data-lucide="eye" class="eye-icon"></i>
                  <i data-lucide="eye-off" class="eye-off-icon" style="display: none;"></i>
                </button>
              </div>
              <div class="password-strength" id="passwordStrength">
                <div class="strength-bars">
                  <span class="strength-bar"></span>
                  <span class="strength-bar"></span>
                  <span class="strength-bar"></span>
                  <span class="strength-bar"></span>
                </div>
                <span class="strength-text">Password strength</span>
              </div>
              <span class="field-error" id="newPasswordError"></span>
            </div>

            <div class="form-group">
              <label for="confirmNewPassword">Confirm New Password</label>
              <div class="input-wrapper password-wrapper">
                <i data-lucide="lock" class="input-icon"></i>
                <input type="password" id="confirmNewPassword" name="confirmPassword" placeholder="Confirm your new password" required minlength="8">
                <button type="button" class="password-toggle" onclick="togglePassword('confirmNewPassword')">
                  <i data-lucide="eye" class="eye-icon"></i>
                  <i data-lucide="eye-off" class="eye-off-icon" style="display: none;"></i>
                </button>
              </div>
              <span class="password-match" id="passwordMatch"></span>
              <span class="field-error" id="confirmNewPasswordError"></span>
            </div>

            <button type="submit" class="btn btn-primary btn-full" id="resetPasswordBtn">
              <span class="btn-text">Reset Password</span>
              <span class="btn-loader" style="display: none;">
                <i data-lucide="loader-2" class="spin"></i>
                Resetting...
              </span>
              <i data-lucide="shield-check" class="btn-icon"></i>
            </button>
          </form>

          <div class="password-requirements">
            <p>Password requirements:</p>
            <ul>
              <li id="req-length"><i data-lucide="circle"></i> At least 8 characters</li>
              <li id="req-upper"><i data-lucide="circle"></i> One uppercase letter</li>
              <li id="req-lower"><i data-lucide="circle"></i> One lowercase letter</li>
              <li id="req-number"><i data-lucide="circle"></i> One number</li>
            </ul>
          </div>
        </div>

        <!-- Step 4: Success -->
        <div class="step-content" id="step4">
          <div class="forgot-card-header success-header">
            <div class="header-logo">
              <img src="/images/PARTSFORM-LOGO.webp" alt="PartsForm" class="logo-img">
            </div>
            <div class="success-icon">
              <i data-lucide="check-circle-2"></i>
            </div>
            <h2>Password Reset Complete!</h2>
            <p>Your password has been successfully changed. You can now log in with your new password.</p>
          </div>

          <div class="success-actions">
            <a href="#" class="btn btn-primary btn-full" onclick="openLoginModal(); return false;">
              <i data-lucide="log-in" class="btn-icon-left"></i>
              <span>Sign In Now</span>
            </a>
            <a href="/" class="btn btn-secondary btn-full">
              <i data-lucide="home" class="btn-icon-left"></i>
              <span>Back to Home</span>
            </a>
          </div>

          <div class="security-notice">
            <i data-lucide="shield"></i>
            <p>For your security, all other sessions have been logged out. You'll need to sign in again on other devices.</p>
          </div>
        </div>

      </div>
    </div>

    <!-- Help Section -->
    <div class="help-section">
      <p>Need help? <a href="/contacts">Contact Support</a></p>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initialize Lucide icons
  if (typeof lucide !== 'undefined') {
    lucide.createIcons();
  }

  // State management
  let currentStep = 1;
  let userEmail = '';
  let resetToken = '';
  let countdownInterval = null;
  let countdownSeconds = 15 * 60; // 15 minutes

  // DOM Elements
  const stepContents = document.querySelectorAll('.step-content');
  const progressSteps = document.querySelectorAll('.progress-step');
  const progressLines = document.querySelectorAll('.progress-line');

  // Code input handling
  const codeInputs = document.querySelectorAll('.code-input');
  codeInputs.forEach((input, index) => {
    input.addEventListener('input', function(e) {
      // Only allow numbers
      this.value = this.value.replace(/[^0-9]/g, '');
      
      if (this.value.length === 1 && index < codeInputs.length - 1) {
        codeInputs[index + 1].focus();
      }
      
      // Check if all inputs are filled
      const code = getVerificationCode();
      if (code.length === 6) {
        // Auto-submit when all digits entered
        document.getElementById('verifyCodeBtn').focus();
      }
    });

    input.addEventListener('keydown', function(e) {
      if (e.key === 'Backspace' && this.value === '' && index > 0) {
        codeInputs[index - 1].focus();
      }
    });

    // Handle paste
    input.addEventListener('paste', function(e) {
      e.preventDefault();
      const pastedData = (e.clipboardData || window.clipboardData).getData('text');
      const digits = pastedData.replace(/[^0-9]/g, '').split('');
      
      codeInputs.forEach((input, i) => {
        if (digits[i]) {
          input.value = digits[i];
        }
      });
      
      // Focus last filled input or submit button
      const lastFilledIndex = Math.min(digits.length - 1, codeInputs.length - 1);
      if (digits.length >= 6) {
        document.getElementById('verifyCodeBtn').focus();
      } else {
        codeInputs[lastFilledIndex + 1]?.focus();
      }
    });
  });

  // Get verification code from inputs
  function getVerificationCode() {
    return Array.from(codeInputs).map(input => input.value).join('');
  }

  // Step 1: Email Form
  document.getElementById('emailForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const emailInput = document.getElementById('email');
    userEmail = emailInput.value.trim();

    if (!userEmail) {
      showStepError(1, 'Please enter your email address');
      return;
    }

    if (!isValidEmail(userEmail)) {
      showStepError(1, 'Please enter a valid email address');
      return;
    }

    setLoading('sendCodeBtn', true);
    hideStepError(1);

    try {
      const response = await fetch('/forgot-password', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email: userEmail }),
      });

      const result = await response.json();

      if (result.success) {
        document.getElementById('displayEmail').textContent = userEmail;
        goToStep(2);
        startCountdown();
        
        // Start resend cooldown based on rate limit
        if (result.rateLimit && result.rateLimit.nextDelay > 0) {
          startResendCooldown(result.rateLimit.nextDelay);
        }
      } else {
        // Handle rate limit error (429)
        if (result.retryAfter) {
          showStepError(1, result.message);
        } else {
          showStepError(1, result.message || 'Failed to send verification code');
        }
      }
    } catch (error) {
      console.error('Error:', error);
      showStepError(1, 'An error occurred. Please try again.');
    } finally {
      setLoading('sendCodeBtn', false);
    }
  });

  // Step 2: Verify Code Form
  document.getElementById('verifyForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const code = getVerificationCode();

    if (code.length !== 6) {
      showStepError(2, 'Please enter the complete 6-digit code');
      return;
    }

    setLoading('verifyCodeBtn', true);
    hideStepError(2);

    try {
      const response = await fetch('/forgot-password/verify', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email: userEmail, code: code }),
      });

      const result = await response.json();

      if (result.success) {
        resetToken = result.resetToken;
        stopCountdown();
        goToStep(3);
        document.getElementById('newPassword').focus();
      } else {
        showStepError(2, result.message || 'Invalid verification code');
        // Clear code inputs
        codeInputs.forEach(input => input.value = '');
        codeInputs[0].focus();
      }
    } catch (error) {
      console.error('Error:', error);
      showStepError(2, 'An error occurred. Please try again.');
    } finally {
      setLoading('verifyCodeBtn', false);
    }
  });

  // Step 3: Reset Password Form
  document.getElementById('resetForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const password = document.getElementById('newPassword').value;
    const confirmPassword = document.getElementById('confirmNewPassword').value;

    if (password.length < 8) {
      showStepError(3, 'Password must be at least 8 characters long');
      return;
    }

    if (password !== confirmPassword) {
      showStepError(3, 'Passwords do not match');
      return;
    }

    setLoading('resetPasswordBtn', true);
    hideStepError(3);

    try {
      const response = await fetch('/forgot-password/reset', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          email: userEmail,
          resetToken: resetToken,
          password: password,
          confirmPassword: confirmPassword,
        }),
      });

      const result = await response.json();

      if (result.success) {
        goToStep(4);
      } else {
        showStepError(3, result.message || 'Failed to reset password');
      }
    } catch (error) {
      console.error('Error:', error);
      showStepError(3, 'An error occurred. Please try again.');
    } finally {
      setLoading('resetPasswordBtn', false);
    }
  });

  // Rate limit tracking
  let resendCooldown = 0;
  let resendCooldownInterval = null;

  function startResendCooldown(seconds) {
    const resendLink = document.getElementById('resendLink');
    resendCooldown = seconds;
    
    if (resendCooldownInterval) {
      clearInterval(resendCooldownInterval);
    }
    
    resendLink.classList.add('disabled');
    updateResendLinkText();
    
    resendCooldownInterval = setInterval(() => {
      resendCooldown--;
      if (resendCooldown <= 0) {
        clearInterval(resendCooldownInterval);
        resendCooldownInterval = null;
        resendLink.classList.remove('disabled');
        resendLink.textContent = 'Resend Code';
      } else {
        updateResendLinkText();
      }
    }, 1000);
  }

  function updateResendLinkText() {
    const resendLink = document.getElementById('resendLink');
    if (resendCooldown > 60) {
      const minutes = Math.ceil(resendCooldown / 60);
      resendLink.textContent = `Resend in ${minutes}m`;
    } else if (resendCooldown > 0) {
      resendLink.textContent = `Resend in ${resendCooldown}s`;
    }
  }

  // Resend Code
  document.getElementById('resendLink').addEventListener('click', async function(e) {
    e.preventDefault();
    
    if (this.classList.contains('disabled')) return;
    
    this.classList.add('disabled');
    this.innerHTML = '<i data-lucide="loader-2" class="spin"></i> Sending...';
    lucide.createIcons();

    try {
      const response = await fetch('/forgot-password/resend', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email: userEmail }),
      });

      const result = await response.json();

      if (result.success) {
        // Clear existing code
        codeInputs.forEach(input => input.value = '');
        codeInputs[0].focus();
        
        // Reset code expiration countdown
        countdownSeconds = 15 * 60;
        startCountdown();
        
        // Show success notification with remaining attempts
        let message = 'New verification code sent!';
        if (result.rateLimit && result.rateLimit.remainingAttempts <= 2) {
          message += ` (${result.rateLimit.remainingAttempts} attempts remaining)`;
        }
        showNotification(message, 'success');
        
        // Start resend cooldown based on rate limit
        if (result.rateLimit && result.rateLimit.nextDelay > 0) {
          startResendCooldown(result.rateLimit.nextDelay);
        } else {
          this.classList.remove('disabled');
          this.textContent = 'Resend Code';
        }
      } else {
        // Handle rate limit error
        if (result.retryAfter) {
          startResendCooldown(result.retryAfter);
          if (result.blocked) {
            showNotification(result.message, 'error');
          } else {
            showNotification(result.message, 'warning');
          }
        } else {
          showNotification(result.message || 'Failed to resend code.', 'error');
          this.classList.remove('disabled');
          this.textContent = 'Resend Code';
        }
      }
    } catch (error) {
      console.error('Error:', error);
      showNotification('Failed to resend code. Please try again.', 'error');
      this.classList.remove('disabled');
      this.textContent = 'Resend Code';
    }
  });

  // Password strength checker
  const newPasswordInput = document.getElementById('newPassword');
  const confirmPasswordInput = document.getElementById('confirmNewPassword');
  const passwordStrength = document.getElementById('passwordStrength');
  const passwordMatch = document.getElementById('passwordMatch');

  newPasswordInput.addEventListener('input', function() {
    updatePasswordStrength(this.value);
    updatePasswordRequirements(this.value);
    checkPasswordMatch();
  });

  confirmPasswordInput.addEventListener('input', checkPasswordMatch);

  function updatePasswordStrength(password) {
    const bars = passwordStrength.querySelectorAll('.strength-bar');
    const text = passwordStrength.querySelector('.strength-text');
    
    let strength = 0;
    if (password.length >= 8) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/[a-z]/.test(password)) strength++;
    if (/[0-9]/.test(password)) strength++;
    if (/[^A-Za-z0-9]/.test(password)) strength++;

    const levels = ['', 'Weak', 'Fair', 'Good', 'Strong', 'Very Strong'];
    const colors = ['', '#ef4444', '#f97316', '#eab308', '#22c55e', '#10b981'];

    bars.forEach((bar, index) => {
      bar.style.backgroundColor = index < strength ? colors[strength] : '#e2e8f0';
    });

    text.textContent = password.length > 0 ? levels[strength] : 'Password strength';
    text.style.color = colors[strength] || '#64748b';
  }

  function updatePasswordRequirements(password) {
    const requirements = {
      'req-length': password.length >= 8,
      'req-upper': /[A-Z]/.test(password),
      'req-lower': /[a-z]/.test(password),
      'req-number': /[0-9]/.test(password),
    };

    Object.entries(requirements).forEach(([id, met]) => {
      const li = document.getElementById(id);
      if (!li) return;
      const icon = li.querySelector('i');
      if (!icon) return;
      if (met) {
        li.classList.add('met');
        icon.setAttribute('data-lucide', 'check-circle');
      } else {
        li.classList.remove('met');
        icon.setAttribute('data-lucide', 'circle');
      }
    });
    lucide.createIcons();
  }

  function checkPasswordMatch() {
    const password = newPasswordInput.value;
    const confirm = confirmPasswordInput.value;

    if (confirm.length > 0) {
      if (password === confirm) {
        passwordMatch.textContent = '✓ Passwords match';
        passwordMatch.style.color = '#10b981';
        confirmPasswordInput.classList.remove('error');
        confirmPasswordInput.classList.add('success');
      } else {
        passwordMatch.textContent = '✗ Passwords do not match';
        passwordMatch.style.color = '#ef4444';
        confirmPasswordInput.classList.remove('success');
        confirmPasswordInput.classList.add('error');
      }
    } else {
      passwordMatch.textContent = '';
      confirmPasswordInput.classList.remove('error', 'success');
    }
  }

  // Navigation functions
  window.goToStep = function(step) {
    currentStep = step;
    
    // Update content
    stepContents.forEach((content, index) => {
      content.classList.toggle('active', index + 1 === step);
    });

    // Update progress
    progressSteps.forEach((stepEl, index) => {
      const stepNum = index + 1;
      stepEl.classList.remove('active', 'completed');
      if (stepNum === step) {
        stepEl.classList.add('active');
      } else if (stepNum < step) {
        stepEl.classList.add('completed');
      }
    });

    progressLines.forEach((line, index) => {
      line.classList.toggle('completed', index < step - 1);
    });

    // Re-initialize icons
    lucide.createIcons();
  };

  // Countdown timer
  function startCountdown() {
    stopCountdown();
    countdownSeconds = 15 * 60;
    updateCountdownDisplay();
    
    countdownInterval = setInterval(() => {
      countdownSeconds--;
      updateCountdownDisplay();
      
      if (countdownSeconds <= 0) {
        stopCountdown();
        showStepError(2, 'Verification code expired. Please request a new one.');
      }
    }, 1000);
  }

  function stopCountdown() {
    if (countdownInterval) {
      clearInterval(countdownInterval);
      countdownInterval = null;
    }
  }

  function updateCountdownDisplay() {
    const minutes = Math.floor(countdownSeconds / 60);
    const seconds = countdownSeconds % 60;
    const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    document.getElementById('countdownTimer').textContent = display;
    
    // Change color when time is running low
    const timer = document.getElementById('countdownTimer');
    if (countdownSeconds <= 60) {
      timer.style.color = '#ef4444';
    } else if (countdownSeconds <= 180) {
      timer.style.color = '#f97316';
    } else {
      timer.style.color = '#6b7280';
    }
  }

  // Utility functions
  function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
  }

  function setLoading(btnId, loading) {
    const btn = document.getElementById(btnId);
    const btnText = btn.querySelector('.btn-text');
    const btnLoader = btn.querySelector('.btn-loader');
    const btnIcon = btn.querySelector('.btn-icon');

    btnText.style.display = loading ? 'none' : 'inline';
    btnLoader.style.display = loading ? 'inline-flex' : 'none';
    if (btnIcon) btnIcon.style.display = loading ? 'none' : 'inline';
    btn.disabled = loading;
    
    lucide.createIcons();
  }

  function showStepError(step, message) {
    const errorDiv = document.getElementById(`step${step}Error`);
    const errorMessage = document.getElementById(`step${step}ErrorMessage`);
    errorMessage.textContent = message;
    errorDiv.style.display = 'flex';
    errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  function hideStepError(step) {
    document.getElementById(`step${step}Error`).style.display = 'none';
  }

  function showNotification(message, type = 'info') {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    
    const icons = {
      success: 'check-circle',
      error: 'alert-circle',
      warning: 'alert-triangle',
      info: 'info',
    };
    
    notification.innerHTML = `
      <i data-lucide="${icons[type] || 'info'}"></i>
      <span>${message}</span>
    `;
    
    document.body.appendChild(notification);
    lucide.createIcons();
    
    // Animate in
    setTimeout(() => notification.classList.add('show'), 10);
    
    // Remove after delay (longer for warnings)
    const duration = type === 'warning' ? 5000 : 3000;
    setTimeout(() => {
      notification.classList.remove('show');
      setTimeout(() => notification.remove(), 300);
    }, duration);
  }
});

// Toggle password visibility
function togglePassword(inputId) {
  const input = document.getElementById(inputId);
  const wrapper = input.closest('.password-wrapper');
  const eyeIcon = wrapper.querySelector('.eye-icon');
  const eyeOffIcon = wrapper.querySelector('.eye-off-icon');

  if (input.type === 'password') {
    input.type = 'text';
    eyeIcon.style.display = 'none';
    eyeOffIcon.style.display = 'block';
  } else {
    input.type = 'password';
    eyeIcon.style.display = 'block';
    eyeOffIcon.style.display = 'none';
  }
}

// Open login modal (from landing page)
function openLoginModal() {
  const modal = document.getElementById('sign-in-modal');
  if (modal) {
    modal.classList.add('active');
    document.body.classList.add('modal-open');
    setTimeout(() => {
      const emailInput = modal.querySelector('input[type="email"]');
      if (emailInput) emailInput.focus();
    }, 100);
  }
}
</script>

<!-- Forgot Password Page Styles -->
<link rel="stylesheet" href="/css/forgot-password.css">

<%- include('partials/footer') %>
